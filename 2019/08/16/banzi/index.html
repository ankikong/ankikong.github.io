<!DOCTYPE html>





<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="generator" content="Hexo 3.9.0">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.3.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.3.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.3.0">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    search: {
      root: '/',
      path: ''
    },
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    }
  };
</script>

  <meta name="description" content="simpson12345678910double work(double L,double R)&amp;#123;    double mid=(L+R)/2;    return (f(L)+f(R)+f(mid)*4)*(R-L)/6;&amp;#125;double simpson(double L,double R)&amp;#123;    double mid=(L+R)/2;    double x1=w">
<meta name="keywords" content="ACM,algorithm">
<meta property="og:type" content="article">
<meta property="og:title" content="banzi">
<meta property="og:url" content="https://ankikong.github.io/2019/08/16/banzi/index.html">
<meta property="og:site_name" content="ankikong">
<meta property="og:description" content="simpson12345678910double work(double L,double R)&amp;#123;    double mid=(L+R)/2;    return (f(L)+f(R)+f(mid)*4)*(R-L)/6;&amp;#125;double simpson(double L,double R)&amp;#123;    double mid=(L+R)/2;    double x1=w">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-08-17T13:07:32.750Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="banzi">
<meta name="twitter:description" content="simpson12345678910double work(double L,double R)&amp;#123;    double mid=(L+R)/2;    return (f(L)+f(R)+f(mid)*4)*(R-L)/6;&amp;#125;double simpson(double L,double R)&amp;#123;    double mid=(L+R)/2;    double x1=w">
  <link rel="canonical" href="https://ankikong.github.io/2019/08/16/banzi/">


<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>banzi | ankikong</title>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-129656297-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-129656297-1');
    }
  </script>








  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ankikong</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
    <ul id="menu" class="menu">
        
        
        
          
          <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
    </ul>
</nav>

</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    <div class="reading-progress-bar"></div>

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://ankikong.github.io/2019/08/16/banzi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ankikong">
      <meta itemprop="description" content="ankikong's blog">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ankikong">
    </span>
      <header class="post-header">

        
          <h2 class="post-title" itemprop="name headline">banzi

              
            
          </h2>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-08-16 23:23:40" itemprop="dateCreated datePublished" datetime="2019-08-16T23:23:40+08:00">2019-08-16</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-08-17 21:07:32" itemprop="dateModified" datetime="2019-08-17T21:07:32+08:00">2019-08-17</time>
              </span>
            
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="simpson"><a href="#simpson" class="headerlink" title="simpson"></a>simpson</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">work</span><span class="params">(<span class="keyword">double</span> L,<span class="keyword">double</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> mid=(L+R)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> (f(L)+f(R)+f(mid)*<span class="number">4</span>)*(R-L)/<span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">simpson</span><span class="params">(<span class="keyword">double</span> L,<span class="keyword">double</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> mid=(L+R)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">double</span> x1=work(L,mid),x2=work(mid,R),x3=work(L,R);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">fabs</span>(x1+x2-x3)&lt;eps) <span class="keyword">return</span> x1+x2;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> simpson(L,mid)+simpson(mid,R);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h2 id="三分"><a href="#三分" class="headerlink" title="三分"></a>三分</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="built_in">fabs</span>(lx - rx) &gt; eps || <span class="built_in">fabs</span>(ly - ry) &gt; eps) &#123;</span><br><span class="line">    x1 = lx + (rx - lx) / <span class="number">3</span>; x2 = lx + (rx - lx) / <span class="number">3</span> * <span class="number">2</span>;</span><br><span class="line">    y1 = ly + (ry - ly) / <span class="number">3</span>; y2 = ly + (ry - ly) / <span class="number">3</span> * <span class="number">2</span>;</span><br><span class="line">    t1 = cal(x1, y1); t2 = cal(x2, y2);</span><br><span class="line">    <span class="keyword">if</span> (t1 &gt; t2) &#123;</span><br><span class="line">        lx = x1, ly = y1;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        rx = x2, ry = y2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="随机增量"><a href="#随机增量" class="headerlink" title="随机增量"></a>随机增量</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1e5</span>+<span class="number">100</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    node <span class="keyword">operator</span>+(node a) &#123;<span class="keyword">return</span> (node)&#123;(a.x+x)/<span class="number">2</span>, (a.y+y)/<span class="number">2</span>&#125;;&#125;</span><br><span class="line">    node <span class="keyword">operator</span>-(node a) &#123;<span class="keyword">return</span> (node)&#123;x-a.x, y-a.y&#125;;&#125;</span><br><span class="line">    node <span class="keyword">operator</span>/(<span class="keyword">double</span> a) &#123;<span class="keyword">return</span> (node)&#123;x/a, y/a&#125;;&#125;</span><br><span class="line">    <span class="function">node <span class="title">rev</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> (node) &#123;y, -x&#125;;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">node p[maxn];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dis</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>((a.x-b.x)*(a.x-b.x) + (a.y-b.y)*(a.y-b.y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">center</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (node) &#123;(a.x+b.x)/<span class="number">2</span>, (a.y+b.y)/<span class="number">2</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sqr</span><span class="params">(<span class="keyword">double</span> a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">cal</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y, <span class="keyword">double</span> z, <span class="keyword">double</span> u, <span class="keyword">double</span> v, <span class="keyword">double</span> w)</span> </span>&#123;</span><br><span class="line">    node t;</span><br><span class="line">    t.x = (z*v-w*y)/(x*v-u*y); t.y = (z-t.x*x)/y;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">center</span><span class="params">(node a, node b, node c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a1, a2, b1, b2, c1, c2;</span><br><span class="line">    node ans;</span><br><span class="line">    a1=<span class="number">2</span>*(b.x-a.x),b1=<span class="number">2</span>*(b.y-a.y),c1=sqr(b.x)-sqr(a.x)+sqr(b.y)-sqr(a.y);</span><br><span class="line">    a2=<span class="number">2</span>*(c.x-a.x),b2=<span class="number">2</span>*(c.y-a.y),c2=sqr(c.x)-sqr(a.x)+sqr(c.y)-sqr(a.y);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">fabs</span>(a1) &lt; eps) &#123;</span><br><span class="line">        ans.y=c1/b1;</span><br><span class="line">        ans.x=(c2-ans.y*b2)/a2;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">fabs</span>(b1) &lt; eps) &#123;</span><br><span class="line">        ans.x=c1/a1;</span><br><span class="line">        ans.y=(c2-ans.x*a2)/b2;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ans.x=(c2*b1-c1*b2)/(a2*b1-a1*b2);</span><br><span class="line">        ans.y=(c2*a1-c1*a2)/(b2*a1-b1*a2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    srand(time(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>, &amp;p[i].x, &amp;p[i].y);</span><br><span class="line">    &#125;</span><br><span class="line">    random_shuffle(p+<span class="number">1</span>, p+<span class="number">1</span>+n);</span><br><span class="line">    node o = p[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">double</span> r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) <span class="keyword">if</span> (dis(o, p[i]) &gt; r + eps) &#123;</span><br><span class="line">        o = center(p[<span class="number">1</span>], p[i]); r = dis(o, p[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++) <span class="keyword">if</span> (dis(o, p[j]) &gt; r + eps)&#123;</span><br><span class="line">            o = center(p[i], p[j]); r = dis(o, p[j]);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; j; k++) <span class="keyword">if</span> (dis(o, p[k]) &gt; r + eps) &#123;</span><br><span class="line">                o = center(p[i], p[j], p[k]); r = dis(o, p[k]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.10f\n%.10f %.10f"</span>, r, o.x, o.y);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="高斯消元"><a href="#高斯消元" class="headerlink" title="高斯消元"></a>高斯消元</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1700</span>;</span><br><span class="line"><span class="keyword">int</span> a[maxn][maxn];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> var, equ;</span><br><span class="line"><span class="keyword">int</span> ans[<span class="number">1700</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; free_x;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">g</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mxr, col, k;</span><br><span class="line">    <span class="keyword">for</span> (k=<span class="number">0</span>, col=<span class="number">0</span>; k&lt;equ &amp;&amp; col&lt;equ; k++, col++) &#123;</span><br><span class="line">        mxr=k;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=k+<span class="number">1</span>; i&lt;equ; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">abs</span>(a[mxr][col])&lt;<span class="built_in">abs</span>(a[i][col])) mxr=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (a[mxr][col]==<span class="number">0</span>) &#123;</span><br><span class="line">            free_x.push_back(col), k--;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (mxr!=k) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=col; j&lt;var+<span class="number">1</span>; j++) &#123;</span><br><span class="line">                swap(a[mxr][j], a[k][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=k+<span class="number">1</span>; i&lt;equ; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i][col]!=<span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j=col; j&lt;var+<span class="number">1</span>; j++) &#123;</span><br><span class="line">                    a[i][j]^=a[k][j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=k; i&lt;equ; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i][col]!=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (k&lt;var) <span class="keyword">return</span> var-k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=var<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) &#123;</span><br><span class="line">        ans[i]=a[i][var];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>; j&lt;var; j++) &#123;</span><br><span class="line">            ans[i]^=(a[i][j]&amp;&amp;ans[j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    equ=m*n, var=m*n;</span><br><span class="line">    free_x.clear();</span><br><span class="line">    <span class="comment">// for (int i=0; i&lt;=equ; i++) a[i].reset();</span></span><br><span class="line">    <span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span>(ans));</span><br><span class="line">    <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;m; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> t=i*m+j;</span><br><span class="line">            a[t][t]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i&gt;<span class="number">0</span>) a[(i<span class="number">-1</span>)*m+j][t]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i&lt;n<span class="number">-1</span>) a[(i+<span class="number">1</span>)*m+j][t]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (j&gt;<span class="number">0</span>) a[i*m+j<span class="number">-1</span>][t]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (j&lt;m<span class="number">-1</span>) a[i*m+j+<span class="number">1</span>][t]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="倍增求lca"><a href="#倍增求lca" class="headerlink" title="倍增求lca"></a>倍增求lca</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> f[maxn][<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> dep[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> dept, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    f[u][<span class="number">0</span>] = fa;</span><br><span class="line">    dep[u] = dept;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[u][i<span class="number">-1</span>] &lt; <span class="number">0</span>) f[u][i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">else</span> f[u][i] = f[f[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (to == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(to, dept + <span class="number">1</span>, u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[a] &lt; dep[b]) swap(a, b);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, d = dep[a] - dep[b]; d; i++, d &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (d &amp; <span class="number">1</span>) a = f[a][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a == b) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="built_in">log</span>(n) + <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[a][i] != f[b][i]) a = f[a][i], b = f[b][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[a][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="On求图上所有点的最远点对"><a href="#On求图上所有点的最远点对" class="headerlink" title="On求图上所有点的最远点对"></a>On求图上所有点的最远点对</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">2e5</span> + <span class="number">100</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, w, nxt;</span><br><span class="line">&#125;v[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node2</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> pos;</span><br><span class="line">    ll dis;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node2&amp; tmp) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dis &gt; tmp.dis;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;da[maxn][<span class="number">4</span>];</span><br><span class="line"><span class="keyword">int</span> n, m, cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> head[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">    v[cnt] = (node) &#123;b, c, head[a]&#125;; head[a] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (to == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(to, u);</span><br><span class="line">        da[u][<span class="number">3</span>].dis = da[to][<span class="number">0</span>].dis + v[i].w, da[u][<span class="number">3</span>].pos = to;</span><br><span class="line">        sort(da[u], da[u] + <span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ans = max(ans, da[u][<span class="number">0</span>].dis + da[u][<span class="number">1</span>].dis * <span class="number">2</span> + da[u][<span class="number">2</span>].dis);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (!vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (u != da[to][<span class="number">0</span>].pos) da[u][<span class="number">3</span>].dis = da[to][<span class="number">0</span>].dis + v[i].w;</span><br><span class="line">        <span class="keyword">else</span> da[u][<span class="number">3</span>].dis = da[to][<span class="number">1</span>].dis + v[i].w;</span><br><span class="line">        da[u][<span class="number">3</span>].pos = to;</span><br><span class="line">        sort(da[u], da[u] + <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = max(ans, da[u][<span class="number">0</span>].dis + da[u][<span class="number">1</span>].dis * <span class="number">2</span> + da[u][<span class="number">2</span>].dis);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (!vis[to]) dfs2(to);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="树上主席树"><a href="#树上主席树" class="headerlink" title="树上主席树"></a>树上主席树</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1e5</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> da[maxn], ranks[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, sum;</span><br><span class="line">&#125; tr[maxn*<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> root[maxn];</span><br><span class="line"><span class="keyword">int</span> Tcnt, total;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> num, <span class="keyword">int</span>&amp; x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    tr[++Tcnt] = tr[x]; x = Tcnt; tr[x].sum++;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (num &lt;= mid) ins(num, tr[x].l, l, mid);</span><br><span class="line">    <span class="keyword">else</span> ins(num, tr[x].r, mid+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> ss, <span class="keyword">int</span> bs, <span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> d = tr[tr[bs].l].sum - tr[tr[ss].l].sum;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (k &lt;= d) <span class="keyword">return</span> query(tr[ss].l, tr[bs].l, k, l, mid);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> query(tr[ss].r, tr[bs].r, k - d, mid+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> f[maxn][<span class="number">20</span>], dep[maxn];</span><br><span class="line"><span class="keyword">int</span> head[maxn], to[maxn&lt;&lt;<span class="number">1</span>], nxt[maxn&lt;&lt;<span class="number">1</span>], vcnt;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    to[++vcnt] = b; nxt[vcnt] = head[a]; head[a] = vcnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> dept)</span> </span>&#123;</span><br><span class="line">    dep[u] = dept;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!f[u][i<span class="number">-1</span>]) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span> f[u][i] = f[f[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    ins(ranks[u], root[u] = root[f[u][<span class="number">0</span>]], <span class="number">1</span>, total);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (to[i] == f[u][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">        f[to[i]][<span class="number">0</span>] = u;</span><br><span class="line">        dfs(to[i], dept+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> logs[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[a] &lt; dep[b]) swap(a, b);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, d = dep[a] - dep[b]; d; d&gt;&gt;=<span class="number">1</span>, i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (d&amp;<span class="number">1</span>) a = f[a][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a == b) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = logs[n]; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[a][i] != f[b][i]) a = f[a][i], b = f[b][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[a][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query2</span><span class="params">(<span class="keyword">int</span> ss1, <span class="keyword">int</span> ss2, <span class="keyword">int</span> bs1, <span class="keyword">int</span> bs2, <span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l; <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> d = tr[tr[bs1].l].sum + tr[tr[bs2].l].sum - tr[tr[ss1].l].sum - tr[tr[ss2].l].sum;</span><br><span class="line">    <span class="keyword">if</span> (k &lt;= d) <span class="keyword">return</span> query2(tr[ss1].l, tr[ss2].l, tr[bs1].l, tr[bs2].l, k, l, mid);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> query2(tr[ss1].r, tr[ss2].r, tr[bs1].r, tr[bs2].r, k - d, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> da2[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, tmp; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;tmp);</span><br><span class="line">        da[i] = tmp; da2[i] =  tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(da2 + <span class="number">1</span>, da2 + <span class="number">1</span> + n);</span><br><span class="line">    logs[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++) logs[i] = logs[i&gt;&gt;<span class="number">1</span>]+<span class="number">1</span>;</span><br><span class="line">    total = unique(da2 + <span class="number">1</span>, da2 + <span class="number">1</span> + n) - da2 - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) ranks[i] = lower_bound(da2 + <span class="number">1</span>, da2 + <span class="number">1</span> + total, da[i]) - da2;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, a, b; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b); add(a, b); add(b, a);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>, a, b, k, t;</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;k);</span><br><span class="line">        a ^= ans; t = lca(a, b);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans = da2[query2(root[t], root[f[t][<span class="number">0</span>]], root[a], root[b], k, <span class="number">1</span>, total)]);</span><br><span class="line">        <span class="keyword">if</span> (m) <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="树剖"><a href="#树剖" class="headerlink" title="树剖"></a>树剖</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">3e5</span>+<span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> head[maxn], to[maxn&lt;&lt;<span class="number">1</span>], nxt[maxn&lt;&lt;<span class="number">1</span>], vcnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    to[++vcnt] = b; nxt[vcnt] = head[a]; head[a] = vcnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> son[maxn], sz[maxn], dep[maxn], fa[maxn];</span><br><span class="line"><span class="keyword">int</span> sum[maxn], id[maxn], top[maxn], idd;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">    fa[u] = f; sz[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (to[i] == f) <span class="keyword">continue</span>;</span><br><span class="line">        dep[to[i]] = dep[u] + <span class="number">1</span>; dfs1(to[i], u);</span><br><span class="line">        sz[u] += sz[to[i]];</span><br><span class="line">        <span class="keyword">if</span> (sz[to[i]] &gt; sz[son[u]]) son[u] = to[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> tp)</span> </span>&#123;</span><br><span class="line">    top[u] = tp; id[u] = ++idd;</span><br><span class="line">    <span class="keyword">if</span> (son[u])</span><br><span class="line">        dfs2(son[u], tp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (to[i] != fa[u] &amp;&amp; to[i] != son[u])</span><br><span class="line">            dfs2(to[i], to[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (top[x] != top[y]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[x]] &lt; dep[top[y]]) swap(x, y);</span><br><span class="line">        sum[id[top[x]]]++, sum[id[x] + <span class="number">1</span>]--; <span class="comment">// 区间覆盖</span></span><br><span class="line">        x = fa[top[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &gt; dep[y]) swap(x, y);</span><br><span class="line">    sum[id[x]]++, sum[id[y] + <span class="number">1</span>]--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> da[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, da + i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, a, b; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b);</span><br><span class="line">        add(a, b); add(b, a);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">-1</span>); dfs2(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) update(da[i], da[i + <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) sum[i] += sum[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == da[<span class="number">1</span>]) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sum[id[i]]);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sum[id[i]] - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="模拟退火"><a href="#模拟退火" class="headerlink" title="模拟退火"></a>模拟退火</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> minn = <span class="number">99999999999999999L</span>L;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">dis</span><span class="params">(node&amp; a, node&amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">rands</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (rand() % <span class="number">1000</span>) / <span class="number">1000.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">judge</span><span class="params">(node&amp; now)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) res += dis(da[i], now) * da[i].p;</span><br><span class="line">    <span class="keyword">if</span> (res &lt; minn) minn = res, ans = now;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> T = <span class="number">1e5</span>, dE;</span><br><span class="line">    node now = ans, ne;</span><br><span class="line">    <span class="keyword">while</span>(T &gt; <span class="number">1e-3</span>)&#123;</span><br><span class="line">        ne.x = now.x + T * (rands() * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        ne.y = now.y + T * (rands() * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        dE = judge(now) - judge(ne);</span><br><span class="line">        <span class="keyword">if</span> (dE&gt;<span class="number">0</span> || <span class="built_in">exp</span>(dE/T)&gt;rands()) now = ne;</span><br><span class="line">        T *= <span class="number">0.99</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">1000</span>; i++) &#123;</span><br><span class="line">        ne.x = ans.x + T * (rands() * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        ne.y = ans.y + T * (rands() * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        judge(ne);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-sat"><a href="#2-sat" class="headerlink" title="2 sat"></a>2 sat</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A，B不能同时取,连边A→B’，B→A’</span></span><br><span class="line"><span class="comment">// A，B不能同时不取, A’→B，B’→A</span></span><br><span class="line"><span class="comment">// A，B要么都取，要么都不取,A→B，B→A，A’→B’，B’→A’</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1e4</span>+<span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> head[maxn], to[maxn*<span class="number">100</span>], nxt[maxn*<span class="number">100</span>], cnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    to[cnt] = b, nxt[cnt] = head[a]; head[a] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> ans[maxn];</span><br><span class="line"><span class="keyword">int</span> dfn[maxn], low[maxn], vis[maxn], ins[maxn], dfns, Amount;</span><br><span class="line"><span class="keyword">int</span> belong[maxn], cnts[maxn];</span><br><span class="line"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    vis[u] = ins[u] = <span class="number">1</span>; s.push(u);</span><br><span class="line">    dfn[u] = low[u] = dfns++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; ~i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[to[i]]) tarjan(to[i]), low[u] = min(low[u], low[to[i]]);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ins[to[i]]) low[u] = min(low[u], dfn[to[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (dfn[u] == low[u]) &#123;</span><br><span class="line">        Amount++;</span><br><span class="line">        <span class="keyword">while</span> (x != u) &#123;</span><br><span class="line">            x = s.top(); s.pop(); ins[x] = <span class="number">0</span>;</span><br><span class="line">            belong[x] = Amount; cnts[Amount]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> another[maxn], color[maxn], ind[maxn];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; mp2[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tp</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;=n; i++) mp2[i].clear();</span><br><span class="line">    <span class="built_in">memset</span>(color, <span class="number">0</span>, <span class="keyword">sizeof</span>(color));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=(n&lt;&lt;<span class="number">1</span>); i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=head[i]; ~j; j=nxt[j]) &#123;</span><br><span class="line">            <span class="keyword">int</span> t=to[j];</span><br><span class="line">            <span class="keyword">if</span> (belong[i]!=belong[t]) &#123;</span><br><span class="line">                mp2[belong[t]].push_back(belong[i]);</span><br><span class="line">                ind[belong[i]]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">        another[belong[i]]=belong[i+n];</span><br><span class="line">        another[belong[i+n]]=belong[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=Amount; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ind[i]==<span class="number">0</span>) q.push(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> nw; !q.empty(); q.pop()) &#123;</span><br><span class="line">        nw=q.front();</span><br><span class="line">        <span class="keyword">if</span> (color[nw]==<span class="number">0</span>) &#123;</span><br><span class="line">            color[nw]=<span class="string">'R'</span>; color[another[nw]]=<span class="string">'B'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t:mp2[nw]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!(--ind[t])) &#123;</span><br><span class="line">                q.push(t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">memset</span>(dfn, <span class="number">0</span>, <span class="keyword">sizeof</span>(dfn));</span><br><span class="line">    <span class="built_in">memset</span>(low, <span class="number">0</span>, <span class="keyword">sizeof</span>(low));</span><br><span class="line">    <span class="built_in">memset</span>(belong, <span class="number">0</span>, <span class="keyword">sizeof</span>(belong));</span><br><span class="line">    <span class="keyword">while</span> (!s.empty()) ins[s.top()] = <span class="number">0</span>, s.pop();</span><br><span class="line">    Amount = cnt = dfns = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">char</span> s1[<span class="number">10</span>], s2[<span class="number">10</span>], s3[<span class="number">10</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> n, k; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;k, &amp;n);</span><br><span class="line">    <span class="comment">// for (int i=1; i&lt;=k; i++) add(i, i+k), add(i+k, i);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>, a, b, c, _a, _b, _c; i&lt;n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%s%d%s%d%s"</span>, &amp;a, s1, &amp;b, s2, &amp;c, s3);</span><br><span class="line">        <span class="keyword">if</span> (s1[<span class="number">0</span>]==<span class="string">'R'</span>) _a=a+k; <span class="keyword">else</span> _a=a, a+=k;</span><br><span class="line">        <span class="keyword">if</span> (s2[<span class="number">0</span>]==<span class="string">'R'</span>) _b=b+k; <span class="keyword">else</span> _b=b, b+=k;</span><br><span class="line">        <span class="keyword">if</span> (s3[<span class="number">0</span>]==<span class="string">'R'</span>) _c=c+k; <span class="keyword">else</span> _c=c, c+=k;</span><br><span class="line">        add(_a, b); add(_a, c);</span><br><span class="line">        add(_b, a); add(_b, c);</span><br><span class="line">        add(_c, a); add(_c, b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=(k&lt;&lt;<span class="number">1</span>); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i]) tarjan(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> flag=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=k; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (belong[i]==belong[i+k]) &#123;</span><br><span class="line">            flag=<span class="literal">true</span>; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag) <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        tp(k);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=k*<span class="number">2</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (color[belong[i]]==<span class="string">'R'</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i&lt;=k) ans[i]=<span class="string">'R'</span>;</span><br><span class="line">                <span class="keyword">else</span> ans[i-k]=<span class="string">'B'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// printf("%c", color[belong[i]]);</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=k; i++) <span class="built_in">printf</span>(<span class="string">"%c"</span>, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1e4</span>+<span class="number">100</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; mp[maxn];</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (vis[x^<span class="number">1</span>]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (vis[x]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    vis[x]=<span class="number">1</span>; s.push(x);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> t:mp[x]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!dfs(t)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">twoSat</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i+=<span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[i] || vis[i^<span class="number">1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span> (s.size()) s.pop();</span><br><span class="line">        <span class="keyword">if</span> (!dfs(i)) &#123;</span><br><span class="line">            <span class="keyword">while</span> (s.size()) vis[s.top()]=<span class="literal">false</span>, s.pop();</span><br><span class="line">            <span class="keyword">if</span> (!dfs(i^<span class="number">1</span>)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">char</span> s1[<span class="number">10</span>], s2[<span class="number">10</span>], s3[<span class="number">10</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, k; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;k, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>, a, b, c, _a, _b, _c; i&lt;n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%s%d%s%d%s"</span>, &amp;a, s1, &amp;b, s2, &amp;c, s3);</span><br><span class="line">        a--; a&lt;&lt;=<span class="number">1</span>; <span class="keyword">if</span> (s1[<span class="number">0</span>]==<span class="string">'R'</span>) _a=a^<span class="number">1</span>; <span class="keyword">else</span> _a=a, a^=<span class="number">1</span>;</span><br><span class="line">        b--; b&lt;&lt;=<span class="number">1</span>; <span class="keyword">if</span> (s2[<span class="number">0</span>]==<span class="string">'R'</span>) _b=b^<span class="number">1</span>; <span class="keyword">else</span> _b=b, b^=<span class="number">1</span>;</span><br><span class="line">        c--; c&lt;&lt;=<span class="number">1</span>; <span class="keyword">if</span> (s3[<span class="number">0</span>]==<span class="string">'R'</span>) _c=c^<span class="number">1</span>; <span class="keyword">else</span> _c=c, c^=<span class="number">1</span>;</span><br><span class="line">        mp[_a].push_back(b); mp[_a].push_back(c);</span><br><span class="line">        mp[_b].push_back(a); mp[_b].push_back(c);</span><br><span class="line">        mp[_c].push_back(a); mp[_c].push_back(b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (twoSat(k*<span class="number">2</span>)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>*k; i+=<span class="number">2</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c"</span>, <span class="string">"BR"</span>[vis[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="tarjan缩点"><a href="#tarjan缩点" class="headerlink" title="tarjan缩点"></a>tarjan缩点</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = head[i]; j; j = nxt[j]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (belong[i] != belong[to[j]] &amp;&amp; !vis[to[j]]) &#123;</span><br><span class="line">            Add(belong[i], belong[to[j]]);</span><br><span class="line">            in[belong[to[j]]]++; vis[belong[to[j]]] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = head[i]; j; j = nxt[j]) &#123;</span><br><span class="line">        vis[belong[to[j]]] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="点分"><a href="#点分" class="headerlink" title="点分"></a>点分</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">2e4</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> head[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, w, nxt;</span><br><span class="line">&#125; v[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">    v[++cnt] = (node) &#123;b, c, head[a]&#125;; head[a] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"><span class="keyword">int</span> son[maxn], mSon[maxn], root;</span><br><span class="line"><span class="keyword">int</span> n, sum;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getRt</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    son[x] = <span class="number">1</span>, mSon[x] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[x]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (vis[to] || to == fa) <span class="keyword">continue</span>;</span><br><span class="line">        getRt(to, x);</span><br><span class="line">        son[x] += son[to];</span><br><span class="line">        mSon[x] = max(mSon[x], son[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    mSon[x] = max(mSon[x], sum - son[x]);</span><br><span class="line">    <span class="keyword">if</span> (mSon[x] &lt; mSon[root]) root = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> dep[maxn], ct[<span class="number">10</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getDep</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    ct[dep[u]]++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (to == fa || vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        dep[to] = (dep[u] + v[i].w) % <span class="number">3</span>;</span><br><span class="line">        getDep(to, u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> now)</span> </span>&#123;</span><br><span class="line">    ct[<span class="number">0</span>] = ct[<span class="number">1</span>] = ct[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    dep[x] = now; getDep(x, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> ct[<span class="number">0</span>] * ct[<span class="number">0</span>] + ct[<span class="number">1</span>] * ct[<span class="number">2</span>] * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    ans += cal(x, <span class="number">0</span>); vis[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[x]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        ans -= cal(to, v[i].w);</span><br><span class="line">        root = <span class="number">0</span>; sum = son[to]; getRt(to, <span class="number">-1</span>);</span><br><span class="line">        solve(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, a, b, c; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;c); c %= <span class="number">3</span>;</span><br><span class="line">        add(a, b, c); add(b, a, c);</span><br><span class="line">    &#125;</span><br><span class="line">    mSon[<span class="number">0</span>] = inf; sum = n;</span><br><span class="line">    getRt(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    solve(root);</span><br><span class="line">    <span class="keyword">int</span> gcd = __gcd(ans, n * n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d/%d\n"</span>, ans / gcd, n * n / gcd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="匈牙利算法"><a href="#匈牙利算法" class="headerlink" title="匈牙利算法"></a>匈牙利算法</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 二分图最大独立集(点数-最大匹配数)</span></span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">10101</span>];</span><br><span class="line"><span class="keyword">int</span> fa[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (vis[u]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!fa[to[i]] || dfs(fa[to[i]])) &#123;</span><br><span class="line">            fa[to[i]] = u;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    ans+=dfs(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="极角排序-叉积"><a href="#极角排序-叉积" class="headerlink" title="极角排序+叉积"></a>极角排序+叉积</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">4000</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    ll x, y;</span><br><span class="line">&#125;da[maxn], da2[maxn];</span><br><span class="line"><span class="function">ll <span class="title">cal</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.x * b.y - b.x * a.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">cmp1</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cal(a, b) &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">cmp2</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a.y != b.y) <span class="keyword">return</span> a.y &lt; b.y;</span><br><span class="line">    <span class="keyword">return</span> a.x &lt; b.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(lld lld, &amp;da[i].x, &amp;da[i].y);</span><br><span class="line">    &#125;</span><br><span class="line">    sort(da+<span class="number">1</span>, da+<span class="number">1</span>+n, cmp2);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        ll sumx = <span class="number">0</span>, sumy = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            sumx += da2[++cnt].x = da[j].x - da[i].x;</span><br><span class="line">            sumy += da2[cnt].y = da[j].y - da[i].y;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(da2+<span class="number">1</span>, da2+<span class="number">1</span>+cnt, cmp1);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cnt; j++) &#123;</span><br><span class="line">            sumx -= da2[j].x;</span><br><span class="line">            sumy -= da2[j].y;</span><br><span class="line">            ans += (da2[j].x * sumy - da2[j].y * sumx);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(lld <span class="string">"."</span> lld, ans&gt;&gt;<span class="number">1</span>, (ans&amp;<span class="number">1</span>)*<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="逆元"><a href="#逆元" class="headerlink" title="逆元"></a>逆元</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a, ll b, ll&amp; d, ll&amp;x, ll&amp; y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        d = a, x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        exgcd(b, a%b, d, y, x);</span><br><span class="line">        y -= x * (a / b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll a, ll mod)</span> </span>&#123;</span><br><span class="line">    ll x, y, d;</span><br><span class="line">    exgcd(a, mod, d, x, y);</span><br><span class="line">    <span class="keyword">return</span> (x%mod+mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 线性求逆元</span></span><br><span class="line">ll invs[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getInv</span><span class="params">(<span class="keyword">int</span> mod)</span> </span>&#123;</span><br><span class="line">    invs[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxn; i++) &#123;</span><br><span class="line">        invs[i] = <span class="number">1L</span>L * invs[mod%i] * (mod-mod/i) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="矩阵快速幂"><a href="#矩阵快速幂" class="headerlink" title="矩阵快速幂"></a>矩阵快速幂</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1e6</span>+<span class="number">100</span>;</span><br><span class="line">ll mod;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mat</span> &#123;</span></span><br><span class="line">    ll a[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">    mat()&#123;<span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));&#125;</span><br><span class="line">    mat <span class="keyword">operator</span>* (<span class="keyword">const</span> mat&amp; A) <span class="keyword">const</span> &#123;</span><br><span class="line">        mat ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;<span class="number">2</span>; j++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">0</span>; k&lt;<span class="number">2</span>; k++)</span><br><span class="line">                    ans.a[i][j]+=a[i][k]*A.a[k][j]%mod;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>; i++) a[i][i]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> mat <span class="title">qpow</span><span class="params">(mat A, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    mat ans; ans.init();</span><br><span class="line">    <span class="keyword">for</span> (; b; b&gt;&gt;=<span class="number">1</span>, A=A*A) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>) ans=ans*A;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">mat <span class="title">qpow</span><span class="params">(mat A, <span class="keyword">char</span>* b, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    mat ans; ans.init();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=len; i; i--) &#123;</span><br><span class="line">        <span class="keyword">int</span> cnt=b[i]-<span class="string">'0'</span>;</span><br><span class="line">        ans=ans*qpow(A, cnt);</span><br><span class="line">        A=qpow(A, <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">char</span> s[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll x0, x1, a, b;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld%lld%s%lld"</span>, &amp;x0, &amp;x1, &amp;a, &amp;b, s+<span class="number">1</span>, &amp;mod);</span><br><span class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">    s[len]--;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=len; s[i]&lt;<span class="string">'0'</span> &amp;&amp; i; i--) s[i<span class="number">-1</span>]--, s[i]+=<span class="number">10</span>;</span><br><span class="line">    mat A; A.a[<span class="number">0</span>][<span class="number">0</span>]=a; A.a[<span class="number">0</span>][<span class="number">1</span>]=b; A.a[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">1</span>; A.a[<span class="number">1</span>][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    A=qpow(A, s, len);</span><br><span class="line">    ll ans=(A.a[<span class="number">0</span>][<span class="number">0</span>]*x1%mod+A.a[<span class="number">0</span>][<span class="number">1</span>]*x0%mod)%mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="dinic"><a href="#dinic" class="headerlink" title="dinic"></a>dinic</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">6e4</span>;</span><br><span class="line"><span class="keyword">int</span> head[maxn], to[maxn&lt;&lt;<span class="number">6</span>], nxt[maxn&lt;&lt;<span class="number">6</span>], w[maxn&lt;&lt;<span class="number">6</span>], vcnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">    to[vcnt] = b; w[vcnt] = c; nxt[vcnt] = head[a]; head[a] = vcnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> start, stop;</span><br><span class="line"><span class="keyword">int</span> dep[maxn];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dep, <span class="number">-1</span>, <span class="keyword">sizeof</span>(dep));</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q; q.push(start);</span><br><span class="line">    dep[start] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = head[x]; ~i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (w[i] &amp;&amp; dep[to[i]] == <span class="number">-1</span>) &#123;</span><br><span class="line">                q.push(to[i]);</span><br><span class="line">                dep[to[i]] = dep[x] + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[stop] != <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> flow)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u == stop) <span class="keyword">return</span> flow;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; ~i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> t = to[i];</span><br><span class="line">        <span class="keyword">if</span> (w[i] &amp;&amp; dep[t] == dep[u] + <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> f = dfs(t, min(flow, w[i]));</span><br><span class="line">            flow -= f; w[i] -= f; w[i^<span class="number">1</span>] += f;</span><br><span class="line">            res += f;</span><br><span class="line">            <span class="keyword">if</span> (!flow) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!res) dep[u] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dinic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (bfs()) &#123;</span><br><span class="line">        ans += dfs(start, inf);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head));</span><br><span class="line">    vcnt = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="spfa-费用流"><a href="#spfa-费用流" class="headerlink" title="spfa 费用流"></a>spfa 费用流</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">2000</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxm=<span class="number">3000100</span>;</span><br><span class="line"><span class="keyword">int</span> start, stop;</span><br><span class="line"><span class="keyword">int</span> head[maxn], nxt[maxm], to[maxm], f[maxm], w[maxm], fr[maxm], vcnt;</span><br><span class="line"><span class="keyword">void</span> _add(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> ww) &#123;</span><br><span class="line">    to[vcnt]=b; f[vcnt]=c; w[vcnt]=ww; nxt[vcnt]=head[a]; fr[vcnt] = a; head[a]=vcnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> ww)</span> </span>&#123;</span><br><span class="line">    _add(a, b, c, ww);</span><br><span class="line">    _add(b, a, <span class="number">0</span>, -ww);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> dis[maxn], from[maxn];</span><br><span class="line"><span class="keyword">bool</span> inq[maxn];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(dis));</span><br><span class="line">    <span class="built_in">memset</span>(inq, <span class="number">0</span>, <span class="keyword">sizeof</span>(inq));</span><br><span class="line">    <span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    q.push_back(<span class="number">0</span>); dis[<span class="number">0</span>]=<span class="number">0</span>; inq[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop_front(); inq[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=head[x]; ~i; i=nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (f[i] &amp;&amp; dis[to[i]] &gt; dis[x]+w[i]) &#123;</span><br><span class="line">                dis[to[i]] = dis[x] + w[i];</span><br><span class="line">                from[to[i]] = i;</span><br><span class="line">                <span class="keyword">if</span> (!inq[to[i]]) &#123;</span><br><span class="line">                    inq[to[i]] = <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (q.size() &amp;&amp; dis[to[i]] &lt; dis[q.front()]) &#123;</span><br><span class="line">                        q.push_front(to[i]);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        q.push_back(to[i]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dis[stop] != inf;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mcf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = inf;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = stop; i; i=fr[from[i]]) &#123;</span><br><span class="line">        x = min(x, f[from[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = stop; i; i=fr[from[i]]) &#123;</span><br><span class="line">        ans += x * w[from[i]];</span><br><span class="line">        f[from[i]] -= x; f[from[i]^<span class="number">1</span>] += x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(spfa())&#123;</span><br><span class="line">    mcf();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="线性基"><a href="#线性基" class="headerlink" title="线性基"></a>线性基</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">64</span>; ~j; j--) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((da[i].x&gt;&gt;j)&amp;<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p[j]) da[i].x^=p[j];</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                p[j]=da[i].x; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="线性基的交"><a href="#线性基的交" class="headerlink" title="线性基的交"></a>线性基的交</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">uint x[<span class="number">32</span>], y[<span class="number">32</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) x[i]=y[i]=tr[a][i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;</span><br><span class="line">        uint u=tr[b][i], k=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (!u) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">31</span>; ~j; j--) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((u&gt;&gt;j)&amp;<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (x[j]) u^=x[j], k^=y[j];</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    x[j]=u, y[j]=k; <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!u) ins(tr[rt], k);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rope"><a href="#rope" class="headerlink" title="rope"></a>rope</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">2e6</span>+<span class="number">100</span>;</span><br><span class="line"><span class="keyword">char</span> str1[maxn], str2[maxn];</span><br><span class="line">rope&lt;<span class="keyword">char</span>&gt; da, revda, tmp;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, x, now=<span class="number">0</span>, len; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">char</span> opt[<span class="number">50</span>];</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, opt);</span><br><span class="line">        len=da.length();</span><br><span class="line">        <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">'I'</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%*c"</span>, &amp;x);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;x; i++) &#123;</span><br><span class="line">                str1[i]=getchar();</span><br><span class="line">                str2[x-i<span class="number">-1</span>]=str1[i];</span><br><span class="line">            &#125;</span><br><span class="line">            str1[x]=str2[x]=<span class="number">0</span>;</span><br><span class="line">            da.insert(now, str1);</span><br><span class="line">            revda.insert(len-now, str2);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">'M'</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x); now=x;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">'D'</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">            da.erase(now, x);</span><br><span class="line">            revda.erase(len-now-x, x);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">'R'</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">            tmp=da.substr(now, x);</span><br><span class="line">            da=da.substr(<span class="number">0</span>, now)+revda.substr(len-now-x, x)+da.substr(now+x, len-now-x);</span><br><span class="line">            revda=revda.substr(<span class="number">0</span>, len-now-x)+tmp+revda.substr(len-now, now);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">'G'</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c\n"</span>, da[now]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">'P'</span>) &#123;</span><br><span class="line">            now--;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">'N'</span>) &#123;</span><br><span class="line">            now++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="后缀自动机"><a href="#后缀自动机" class="headerlink" title="后缀自动机"></a>后缀自动机</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 广义sam，last置为1，然后插入新串， ed置为串id</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">5e5</span>+<span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sam</span> &#123;</span></span><br><span class="line"><span class="comment">//点i ii上面表示子串的数量为len[fa[i]]−len[i]</span></span><br><span class="line"><span class="comment">//在parents上，父亲是儿子上的子串的公共后缀</span></span><br><span class="line"><span class="comment">//父亲上的子串出现次数，是儿子上的子串出现次数之和</span></span><br><span class="line"><span class="comment">//在一个点上的子串，短的为长的的后缀</span></span><br><span class="line"><span class="comment">//len数组表示的是这个节上的子串最长长度</span></span><br><span class="line">    <span class="keyword">int</span> len[maxn&lt;&lt;<span class="number">1</span>], fa[maxn&lt;&lt;<span class="number">1</span>], son[maxn&lt;&lt;<span class="number">1</span>][<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">int</span> ed[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">int</span> sz, last;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;sz=last=<span class="number">1</span>;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> s=c-<span class="string">'a'</span>;</span><br><span class="line">        <span class="keyword">int</span> p=last, np=++sz;</span><br><span class="line">        last=np; ed[np]=<span class="number">1</span>; len[np]=len[p]+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; p &amp;&amp; !son[p][s]; p=fa[p]) son[p][s]=np;</span><br><span class="line">        <span class="keyword">if</span> (!p) fa[np]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> q=son[p][s];</span><br><span class="line">            <span class="keyword">if</span> (len[p]+<span class="number">1</span>==len[q]) fa[np]=q;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> nq=++sz; len[nq]=len[p]+<span class="number">1</span>;</span><br><span class="line">                <span class="built_in">memcpy</span>(son[nq], son[q], <span class="keyword">sizeof</span>(son[q]));</span><br><span class="line">                fa[nq]=fa[q]; fa[q]=fa[np]=nq;</span><br><span class="line">                <span class="keyword">for</span> (; q==son[p][s] &amp;&amp; p; p=fa[p]) son[p][s]=nq;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(<span class="keyword">char</span> *str)</span> </span>&#123;</span><br><span class="line">        init();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; str[i]; i++) &#123;</span><br><span class="line">            ins(str[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> x[maxn&lt;&lt;<span class="number">1</span>], y[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">msort</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=sz; i++) x[len[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=sz; i++) x[i]+=x[i<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=sz; i++) y[x[len[i]]--]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ll ans1=<span class="number">1L</span>L*n*(n+<span class="number">1</span>)/<span class="number">2</span>*(n<span class="number">-1</span>), ans2=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=sz; i; i--) &#123;</span><br><span class="line">            <span class="keyword">int</span> tp = y[i];</span><br><span class="line">            ans2+=<span class="number">1L</span>L*ed[fa[tp]]*len[fa[tp]]*ed[tp];</span><br><span class="line">            ed[fa[tp]]+=ed[tp];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld"</span>, ans1-ans2*<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">count</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ll ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>; i&lt;=sz; i++) ans+=len[i]-len[fa[i]];</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="回文树"><a href="#回文树" class="headerlink" title="回文树"></a>回文树</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fail[i]表示以此节点位结尾，较短的回文串</span></span><br><span class="line"><span class="comment">// num表示以节点i表示的最长回文串的最右端点为回文串结尾的回文串个数</span></span><br><span class="line"><span class="comment">// cnt表示以此节点结尾本质不同的回文串数量，在count()执行后才为正确结果</span></span><br><span class="line"><span class="comment">// 节点数量-2就是本质不同串数量</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">6e5</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Pal</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> nxt[N][<span class="number">26</span>], fail[N], cnt[N], num[N], len[N], S[N], last, n, p;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">newNode</span><span class="params">(<span class="keyword">int</span> l)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(nxt[p], <span class="number">0</span>, <span class="keyword">sizeof</span>(nxt[p]));</span><br><span class="line">        cnt[p]=num[p]=<span class="number">0</span>; len[p]=l;</span><br><span class="line">        <span class="keyword">return</span> p++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        p=<span class="number">0</span>; newNode(<span class="number">0</span>); newNode(<span class="number">-1</span>);</span><br><span class="line">        last=<span class="number">0</span>; n=<span class="number">0</span>; fail[<span class="number">0</span>]=<span class="number">1</span>; S[<span class="number">0</span>]=<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getFail</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (; S[n-len[x]<span class="number">-1</span>]!=S[n]; x=fail[x]);</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">        c-=<span class="string">'a'</span>;</span><br><span class="line">        S[++n]=c;</span><br><span class="line">        <span class="keyword">int</span> cur=getFail(last);</span><br><span class="line">        <span class="keyword">if</span> (!nxt[cur][c]) &#123;</span><br><span class="line">            <span class="keyword">int</span> now=newNode(len[cur]+<span class="number">2</span>);</span><br><span class="line">            fail[now]=nxt[getFail(fail[cur])][c];</span><br><span class="line">            nxt[cur][c]=now;</span><br><span class="line">            num[now]=num[fail[now]]+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last=nxt[cur][c];</span><br><span class="line">        cnt[last]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">count</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=p<span class="number">-1</span>; ~i; i--) cnt[fail[i]]+=cnt[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;pal;</span><br></pre></td></tr></table></figure>

<h2 id="支配树"><a href="#支配树" class="headerlink" title="支配树"></a>支配树</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DAG上点对的LCA</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">tree</span>&#123;</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[maxn], E[maxn];</span><br><span class="line">    <span class="keyword">int</span> ind[maxn], dep[maxn];</span><br><span class="line">    <span class="keyword">int</span> f[maxn][<span class="number">20</span>];</span><br><span class="line">    <span class="keyword">int</span> n, root, tot, a[maxn];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> _n)</span> </span>&#123;</span><br><span class="line">        n=_n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;=n; i++) G[i].clear(), ind[i]=<span class="number">0</span>, dep[i]=<span class="number">0</span>, E[i].clear();</span><br><span class="line">        root=_n+<span class="number">1</span>; tot=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        G[a].push_back(b); E[b].push_back(a);</span><br><span class="line">        ind[a]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">TP</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">if</span> (ind[i]==<span class="number">0</span>) q.push(i), E[root].push_back(i), G[i].push_back(root);</span><br><span class="line">        <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">            <span class="keyword">int</span> u=q.front(); q.pop();</span><br><span class="line">            a[++tot]=u;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> a:E[u])</span><br><span class="line">                <span class="keyword">if</span> ((--ind[a])==<span class="number">0</span>) q.push(a);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[a]&gt;dep[b]) swap(a, b);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">19</span>; ~i; i--) <span class="keyword">if</span> (dep[b]&gt;dep[a] &amp;&amp; dep[f[b][i]]&gt;=dep[a]) b=f[b][i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">19</span>; ~i; i--) <span class="keyword">if</span> (f[a][i]!=f[b][i]) a=f[a][i], b=f[b][i];</span><br><span class="line">        <span class="keyword">return</span> a==b ? a : f[a][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        dep[root]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> u=a[i], fa=<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> v:G[u])</span><br><span class="line">                fa = (fa==<span class="number">-1</span> ? v : lca(fa, v));</span><br><span class="line">            dep[u]=dep[fa]+<span class="number">1</span>; f[u][<span class="number">0</span>]=fa;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;<span class="number">20</span>; i++) f[u][i]=f[f[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;T;</span><br></pre></td></tr></table></figure>

<h2 id="二次同余方程"><a href="#二次同余方程" class="headerlink" title="二次同余方程"></a>二次同余方程</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line">ll w;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a, ll b, ll&amp; d, ll&amp;x, ll&amp; y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        d = a, x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        exgcd(b, a%b, d, y, x);</span><br><span class="line">        y -= x * (a / b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll a, ll mod)</span> </span>&#123;</span><br><span class="line">    ll x, y, d;</span><br><span class="line">    exgcd(a, mod, d, x, y);</span><br><span class="line">    <span class="keyword">return</span> (x%mod+mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a, ll b, ll md)</span> </span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (a%=md; b; b&gt;&gt;=<span class="number">1</span>, a=a*a%md) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>) ans=ans*a%md;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    ll p, d;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">node <span class="title">mul</span><span class="params">(node a, node b, ll md)</span> </span>&#123;</span><br><span class="line">    node ans;</span><br><span class="line">    ans.p=(a.p*b.p%md + a.d*b.d%md*w%md)%md;</span><br><span class="line">    ans.d=(a.p*b.d%md + a.d*b.p%md)%md;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">qpow</span><span class="params">(node a, ll b, ll md)</span> </span>&#123;</span><br><span class="line">    node ans=node&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (; b; b&gt;&gt;=<span class="number">1</span>, a=mul(a, a, md)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>) ans=mul(ans, a, md);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll x, ll md)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (md==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (qpow(x, (md<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>, md)+<span class="number">1</span>==md) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    ll a, t;</span><br><span class="line">    <span class="keyword">for</span> (a=<span class="number">1</span>; a&lt;md; a++) &#123;</span><br><span class="line">        t=a*a - x;</span><br><span class="line">        w=(t+md)%md;</span><br><span class="line">        <span class="keyword">if</span> (qpow(w, (md<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>, md)+<span class="number">1</span>==md) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    node tmp=node&#123;a, <span class="number">1</span>&#125;;</span><br><span class="line">    tmp=qpow(tmp, (md+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>, md);</span><br><span class="line">    <span class="keyword">return</span> tmp.p;</span><br><span class="line">    <span class="comment">// sqrt(x)==tmp.p(%mod)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="连分数"><a href="#连分数" class="headerlink" title="连分数"></a>连分数</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a1/b1 &lt;= den/num &lt;= a2/b2</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">continue_frac</span><span class="params">(ll a1, ll b1, ll a2, ll b2, ll&amp; num, ll&amp; den)</span> </span>&#123;</span><br><span class="line">    ll c1=a1/b1, d1=a1%b1;</span><br><span class="line">    ll c2=a2/b2, d2=a2%b2;</span><br><span class="line">    <span class="keyword">if</span> (c1!=c2 || !d1 || !d2) &#123;</span><br><span class="line">        den=<span class="number">1</span>, num=min(c1, c2)+<span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        continue_frac(b1, d1, b2, d2, den, num);</span><br><span class="line">        num+=c1*den;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SG"><a href="#SG" class="headerlink" title="SG"></a>SG</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getSg</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> sg[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (sg[n] != <span class="number">-1</span>) <span class="keyword">return</span> sg[n];</span><br><span class="line">    <span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; vis;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = n / i, res = n % i;</span><br><span class="line">        <span class="keyword">if</span> (cnt % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (res) vis.insert(getSg(res));</span><br><span class="line">            <span class="keyword">else</span> vis.insert(<span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (res)</span><br><span class="line">                vis.insert(getSg(i) ^ getSg(res));</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                vis.insert(getSg(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; ; i++) <span class="keyword">if</span> (!vis.count(i)) <span class="keyword">return</span> sg[n] = i;</span><br><span class="line">&#125;</span><br><span class="line">sg==<span class="number">0</span>,先手必败</span><br></pre></td></tr></table></figure>

<h2 id="输入挂"><a href="#输入挂" class="headerlink" title="输入挂"></a>输入挂</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> buf[<span class="number">100000</span>],*p1=buf,*p2=buf;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">nc</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p1==p2&amp;&amp;(p2=(p1=buf)+fread(buf,<span class="number">1</span>,<span class="number">100000</span>,<span class="built_in">stdin</span>),p1==p2)?EOF:*p1++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">rea</span><span class="params">(<span class="keyword">int</span> &amp; x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> c=nc();x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(c==EOF) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(c);c=nc());</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);x=x*<span class="number">10</span>+c-<span class="string">'0'</span>,c=nc());</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IO &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">4096</span>;</span><br><span class="line">    <span class="keyword">char</span> buf[maxn], t[<span class="number">50</span>];</span><br><span class="line">    <span class="keyword">int</span> bn=maxn, bi=maxn;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (bn) &#123;</span><br><span class="line">            <span class="keyword">for</span> (; bi&lt;bn &amp;&amp; buf[bi]&lt;=<span class="string">' '</span>; bi++);</span><br><span class="line">            <span class="keyword">if</span> (bi&lt;bn) <span class="keyword">break</span>;</span><br><span class="line">            bn=fread(buf, <span class="number">1</span>, maxn, <span class="built_in">stdin</span>);</span><br><span class="line">            bi=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> sn=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (bn) &#123;</span><br><span class="line">            <span class="keyword">for</span> (; bi&lt;bn &amp;&amp; buf[bi]&gt;<span class="string">' '</span>; bi++) s[sn++]=buf[bi];</span><br><span class="line">            <span class="keyword">if</span> (bi&lt;bn) <span class="keyword">break</span>;</span><br><span class="line">            bn=fread(buf, <span class="number">1</span>, maxn, <span class="built_in">stdin</span>);</span><br><span class="line">            bi=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        s[sn]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> sn;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span>&amp; x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!read(t)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        x=atoi(t);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="原根"><a href="#原根" class="headerlink" title="原根"></a>原根</h2><blockquote>
<p>在$(a,m)=1$时，定义a对模m的指数 $\delta m(a)$为使$a^d \equiv 1 \pmod{m}$ 成立的最小的正整数d<br>若 $\delta m(a)=\varphi(m)$, 则称a是模m的原根<br>素数p的原根个数为 $\varphi(p-1)$<br><strong>指标</strong>:当确定模p和原根g时，定义a的指标为$I(a)$为使$g^d \equiv a \pmod p$成立的最小的正整数d<br>指标性质: $I(ab) \equiv I(a)+I(b) \pmod {p-1}$, $I(a^k) \equiv kI(a) \pmod {p-1}$<br>找$m$的原根：将$\varphi(m)$因数分解，即$\varphi(m)=p_1^{k_1}p_2^{k_2}……p_n^{k_n}$如果一个数$g$是模$m$的原根，则其必然满足对于任意一个$1\leq i\leq n, g^{\frac {\varphi(m)} {p_i}}≠1(mod\ m)$  </p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 素数的原根</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1e6</span>+<span class="number">100</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(ll a, <span class="keyword">int</span> b, <span class="keyword">int</span> mod)</span> </span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b&gt;&gt;=<span class="number">1</span>, a=a*a%mod) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>) ans=ans*a%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getG</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p;</span><br><span class="line">    <span class="keyword">int</span> phi=n<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>; i*i&lt;=phi; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (phi%i==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (phi%i==<span class="number">0</span>) phi/=i;</span><br><span class="line">            p.push_back(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (phi&gt;<span class="number">1</span>) p.push_back(phi);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>; i&lt;n; i++) &#123;</span><br><span class="line">        <span class="keyword">bool</span> flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j:p) &#123;</span><br><span class="line">            <span class="keyword">if</span> (qpow(i, (n<span class="number">-1</span>)/j, n)==<span class="number">1</span>) &#123;</span><br><span class="line">                flag=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag) <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> x[maxn], I[maxn];</span><br><span class="line"><span class="keyword">int</span> cnt[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">cin</span> &gt;&gt; t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n; t--; ) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        <span class="built_in">memset</span>(cnt, <span class="number">0</span>, n&lt;&lt;<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">int</span> g=getG(n);</span><br><span class="line">        I[<span class="number">0</span>]=<span class="number">1</span>; x[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;n; i++) &#123;</span><br><span class="line">            x[i]=<span class="number">1L</span>L*x[i<span class="number">-1</span>]*g%n;</span><br><span class="line">            I[x[i]]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;n; i++) &#123;</span><br><span class="line">            cnt[x[<span class="number">1L</span>L*I[i]*i%(n<span class="number">-1</span>)]]++;</span><br><span class="line">        &#125;</span><br><span class="line">        ll ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i+i&lt;=n; i++) &#123;</span><br><span class="line">            ans+=<span class="number">1L</span>L*cnt[i]*cnt[n-i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="蔡勒公式"><a href="#蔡勒公式" class="headerlink" title="蔡勒公式"></a>蔡勒公式</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getWeek</span><span class="params">(<span class="keyword">int</span> y, <span class="keyword">int</span> m, <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m&lt;<span class="number">3</span>) m+=<span class="number">12</span>, y--;</span><br><span class="line">    <span class="keyword">int</span> c=y/<span class="number">100</span>; y%=<span class="number">100</span>;</span><br><span class="line">    <span class="keyword">return</span> ((y+y/<span class="number">4</span>+c/<span class="number">4</span><span class="number">-2</span>*c+<span class="number">26</span>*(m+<span class="number">1</span>)/<span class="number">10</span>+d<span class="number">-1</span>)%<span class="number">7</span>+<span class="number">7</span>)%<span class="number">7</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h2><p>$$ {\sum_{m|n}φ(m)}=n $$<br>$$ φ^2(n)=φ(n^2) $$<br>$$ 1^2+2^2+3^2+…+n^2=n(n+1)(2n+1)\div 6 $$<br>$$ 1^3+2^3+3^3+…+n^3=n^2(n+1)^2\div 4 $$<br>$$ \sum_{i|n} \mu(i) =[n==1] $$<br>$$ \sum_i^{n} [{gcd(i,n)=1}]=n<em>phi(n)\div 2 $$<br>$$ \sum_{i=1}^{n}(i</em>[gcd(n, i)=1])=i<em>\phi(i)\div 2+[i=1] $$<br>$$ F(n)=\sum_{d|n}f(d) =&gt; f(n)=\sum_{d|n}F(d)<em>\mu(\frac{n}{d}) $$<br>$$ lucas(n, m, p) = C(n%p, m%p)</em>lucas(n/p, m/p, p) $$<br>$$ C_n^m % p=\prod{C_{n_i}^{m_i}}%p,m=\sum{m_ip^i},n=\sum{n_ip^i} $$<br>$$ h(n)=h(n-1)</em>(4*n-2)/(n+1) $$<br>$$ h(n)=C_{2n}^n/(n+1) $$<br>$$ h(n)=C_{2n}^n-C_{2n}^{n+1} $$<br>$$ gcd(Fib[a],Fib[b])=Fib[gcd(a,b)] $$<br>$$ gcd(a^i-1,a^j-1)=a^{gcd(i, j)}-1 $$<br>$$ 球缺：用平面截取球的一部分 $$<br>$$ 球缺面积 = 2 \cdot \pi h $$<br>$$ 球缺体积 = \pi \cdot h^2 \cdot (R - \frac{h}{3}) $$<br>$$ w=\left(y+\lfloor {\frac {y}{4}}\rfloor+\lfloor{\frac {c}{4}}\rfloor-2c+\lfloor{\frac {26(m+1)}{10}}\rfloor+d-1\right){\bmod {7}} $$<br>$$ w：星期; c：年份前两位数; y：年份后两位数;m：月,某年的1、2月要看作上一年的13、14月来计算; d：日 $$</p>

    </div>

    
    
    

    <footer class="post-footer">
          
        
        <div class="post-tags">
            <a href="/tags/ACM/" rel="tag"># ACM</a>
          
            <a href="/tags/algorithm/" rel="tag"># algorithm</a>
          
        </div>
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
              <a href="/2019/08/16/firstBlog/" rel="next" title="firstBlog">
                <i class="fa fa-chevron-left"></i> firstBlog
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
              <a href="/2019/09/06/create-hostapd-with-ipv4-6-support/" rel="prev" title="create hostapd with ipv4&6 support">
                create hostapd with ipv4&6 support <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
    </footer>
  </div>
  
  
  
  </article>

  </div>


          </div>
          


        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ankikong</p>
  <div class="site-description motion-element" itemprop="description">ankikong's blog</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">27</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/ankikong" title="GitHub &rarr; https://github.com/ankikong" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="mailto:ankikong@qq.com" title="E-Mail &rarr; mailto:ankikong@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
    
  </div>



        </div>
      </div>
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#simpson"><span class="nav-number">1.</span> <span class="nav-text">simpson</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三分"><span class="nav-number">2.</span> <span class="nav-text">三分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#随机增量"><span class="nav-number">3.</span> <span class="nav-text">随机增量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#高斯消元"><span class="nav-number">4.</span> <span class="nav-text">高斯消元</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#倍增求lca"><span class="nav-number">5.</span> <span class="nav-text">倍增求lca</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#On求图上所有点的最远点对"><span class="nav-number">6.</span> <span class="nav-text">On求图上所有点的最远点对</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#树上主席树"><span class="nav-number">7.</span> <span class="nav-text">树上主席树</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#树剖"><span class="nav-number">8.</span> <span class="nav-text">树剖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#模拟退火"><span class="nav-number">9.</span> <span class="nav-text">模拟退火</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-sat"><span class="nav-number">10.</span> <span class="nav-text">2 sat</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tarjan缩点"><span class="nav-number">11.</span> <span class="nav-text">tarjan缩点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#点分"><span class="nav-number">12.</span> <span class="nav-text">点分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#匈牙利算法"><span class="nav-number">13.</span> <span class="nav-text">匈牙利算法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#极角排序-叉积"><span class="nav-number">14.</span> <span class="nav-text">极角排序+叉积</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#逆元"><span class="nav-number">15.</span> <span class="nav-text">逆元</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#矩阵快速幂"><span class="nav-number">16.</span> <span class="nav-text">矩阵快速幂</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dinic"><span class="nav-number">17.</span> <span class="nav-text">dinic</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#spfa-费用流"><span class="nav-number">18.</span> <span class="nav-text">spfa 费用流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#线性基"><span class="nav-number">19.</span> <span class="nav-text">线性基</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#线性基的交"><span class="nav-number">19.1.</span> <span class="nav-text">线性基的交</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rope"><span class="nav-number">20.</span> <span class="nav-text">rope</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#后缀自动机"><span class="nav-number">21.</span> <span class="nav-text">后缀自动机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#回文树"><span class="nav-number">22.</span> <span class="nav-text">回文树</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#支配树"><span class="nav-number">23.</span> <span class="nav-text">支配树</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二次同余方程"><span class="nav-number">24.</span> <span class="nav-text">二次同余方程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#连分数"><span class="nav-number">25.</span> <span class="nav-text">连分数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SG"><span class="nav-number">26.</span> <span class="nav-text">SG</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输入挂"><span class="nav-number">27.</span> <span class="nav-text">输入挂</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#原根"><span class="nav-number">28.</span> <span class="nav-text">原根</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#蔡勒公式"><span class="nav-number">29.</span> <span class="nav-text">蔡勒公式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#公式"><span class="nav-number">30.</span> <span class="nav-text">公式</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ankikong</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.3.0</div>

        








        
      </div>
    </footer>
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
      </div>

    

  </div>

  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="/lib/reading_progress/reading_progress.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.ui.min.js"></script>

  <script src="/js/utils.js?v=7.3.0"></script>
  <script src="/js/motion.js?v=7.3.0"></script>

  
  <script src="/js/affix.js?v=7.3.0"></script>
  <script src="/js/schemes/pisces.js?v=7.3.0"></script>



  
  <script src="/js/scrollspy.js?v=7.3.0"></script>
<script src="/js/post-details.js?v=7.3.0"></script>



  <script src="/js/next-boot.js?v=7.3.0"></script>

  

  

  


  





  
    
      <script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

    
  
































</body>
</html>
