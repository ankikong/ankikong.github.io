<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"ankikong.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="simpson12345678910double work(double L,double R)&#123;    double mid&#x3D;(L+R)&#x2F;2;    return (f(L)+f(R)+f(mid)*4)*(R-L)&#x2F;6;&#125;double simpson(double L,double R)&#123;    double mid&#x3D;(L+R)&#x2F;2;    double x1&#x3D;w">
<meta property="og:type" content="article">
<meta property="og:title" content="banzi">
<meta property="og:url" content="https://ankikong.github.io/banzi/index.html">
<meta property="og:site_name" content="ankikong">
<meta property="og:description" content="simpson12345678910double work(double L,double R)&#123;    double mid&#x3D;(L+R)&#x2F;2;    return (f(L)+f(R)+f(mid)*4)*(R-L)&#x2F;6;&#125;double simpson(double L,double R)&#123;    double mid&#x3D;(L+R)&#x2F;2;    double x1&#x3D;w">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-08-16T15:23:40.000Z">
<meta property="article:modified_time" content="2019-08-17T13:07:32.750Z">
<meta property="article:author" content="ankikong">
<meta property="article:tag" content="ACM">
<meta property="article:tag" content="algorithm">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://ankikong.github.io/banzi/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://ankikong.github.io/banzi/","path":"banzi/","title":"banzi"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>banzi | ankikong</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NR7TLCQ044"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-NR7TLCQ044","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js" defer></script>








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">ankikong</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#simpson"><span class="nav-number">1.</span> <span class="nav-text">simpson</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E5%88%86"><span class="nav-number">2.</span> <span class="nav-text">三分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E5%A2%9E%E9%87%8F"><span class="nav-number">3.</span> <span class="nav-text">随机增量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83"><span class="nav-number">4.</span> <span class="nav-text">高斯消元</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B1%82lca"><span class="nav-number">5.</span> <span class="nav-text">倍增求lca</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#On%E6%B1%82%E5%9B%BE%E4%B8%8A%E6%89%80%E6%9C%89%E7%82%B9%E7%9A%84%E6%9C%80%E8%BF%9C%E7%82%B9%E5%AF%B9"><span class="nav-number">6.</span> <span class="nav-text">On求图上所有点的最远点对</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%91%E4%B8%8A%E4%B8%BB%E5%B8%AD%E6%A0%91"><span class="nav-number">7.</span> <span class="nav-text">树上主席树</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%91%E5%89%96"><span class="nav-number">8.</span> <span class="nav-text">树剖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB"><span class="nav-number">9.</span> <span class="nav-text">模拟退火</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-sat"><span class="nav-number">10.</span> <span class="nav-text">2 sat</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tarjan%E7%BC%A9%E7%82%B9"><span class="nav-number">11.</span> <span class="nav-text">tarjan缩点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%82%B9%E5%88%86"><span class="nav-number">12.</span> <span class="nav-text">点分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95"><span class="nav-number">13.</span> <span class="nav-text">匈牙利算法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9E%81%E8%A7%92%E6%8E%92%E5%BA%8F-%E5%8F%89%E7%A7%AF"><span class="nav-number">14.</span> <span class="nav-text">极角排序+叉积</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%86%E5%85%83"><span class="nav-number">15.</span> <span class="nav-text">逆元</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="nav-number">16.</span> <span class="nav-text">矩阵快速幂</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dinic"><span class="nav-number">17.</span> <span class="nav-text">dinic</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#spfa-%E8%B4%B9%E7%94%A8%E6%B5%81"><span class="nav-number">18.</span> <span class="nav-text">spfa 费用流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E5%9F%BA"><span class="nav-number">19.</span> <span class="nav-text">线性基</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E5%9F%BA%E7%9A%84%E4%BA%A4"><span class="nav-number">19.1.</span> <span class="nav-text">线性基的交</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rope"><span class="nav-number">20.</span> <span class="nav-text">rope</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA"><span class="nav-number">21.</span> <span class="nav-text">后缀自动机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9E%E6%96%87%E6%A0%91"><span class="nav-number">22.</span> <span class="nav-text">回文树</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%AF%E9%85%8D%E6%A0%91"><span class="nav-number">23.</span> <span class="nav-text">支配树</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B"><span class="nav-number">24.</span> <span class="nav-text">二次同余方程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9E%E5%88%86%E6%95%B0"><span class="nav-number">25.</span> <span class="nav-text">连分数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SG"><span class="nav-number">26.</span> <span class="nav-text">SG</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%85%A5%E6%8C%82"><span class="nav-number">27.</span> <span class="nav-text">输入挂</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E6%A0%B9"><span class="nav-number">28.</span> <span class="nav-text">原根</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%94%A1%E5%8B%92%E5%85%AC%E5%BC%8F"><span class="nav-number">29.</span> <span class="nav-text">蔡勒公式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AC%E5%BC%8F"><span class="nav-number">30.</span> <span class="nav-text">公式</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ankikong</p>
  <div class="site-description" itemprop="description">ankikong's blog</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">31</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ankikong" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ankikong" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ankikong.github.io/banzi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ankikong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ankikong">
      <meta itemprop="description" content="ankikong's blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="banzi | ankikong">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          banzi
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-16 23:23:40" itemprop="dateCreated datePublished" datetime="2019-08-16T23:23:40+08:00">2019-08-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2019-08-17 21:07:32" itemprop="dateModified" datetime="2019-08-17T21:07:32+08:00">2019-08-17</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="simpson"><a href="#simpson" class="headerlink" title="simpson"></a>simpson</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">double</span> <span class="title">work</span><span class="params">(<span class="type">double</span> L,<span class="type">double</span> R)</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> mid=(L+R)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">f</span>(L)+<span class="built_in">f</span>(R)+<span class="built_in">f</span>(mid)*<span class="number">4</span>)*(R-L)/<span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">simpson</span><span class="params">(<span class="type">double</span> L,<span class="type">double</span> R)</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> mid=(L+R)/<span class="number">2</span>;</span><br><span class="line">    <span class="type">double</span> x1=<span class="built_in">work</span>(L,mid),x2=<span class="built_in">work</span>(mid,R),x3=<span class="built_in">work</span>(L,R);</span><br><span class="line">    <span class="keyword">if</span> (std::<span class="built_in">fabs</span>(x1+x2-x3)&lt;eps) <span class="keyword">return</span> x1+x2;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">simpson</span>(L,mid)+<span class="built_in">simpson</span>(mid,R);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h2 id="三分"><a href="#三分" class="headerlink" title="三分"></a>三分</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="built_in">fabs</span>(lx - rx) &gt; eps || <span class="built_in">fabs</span>(ly - ry) &gt; eps) &#123;</span><br><span class="line">    x1 = lx + (rx - lx) / <span class="number">3</span>; x2 = lx + (rx - lx) / <span class="number">3</span> * <span class="number">2</span>;</span><br><span class="line">    y1 = ly + (ry - ly) / <span class="number">3</span>; y2 = ly + (ry - ly) / <span class="number">3</span> * <span class="number">2</span>;</span><br><span class="line">    t1 = <span class="built_in">cal</span>(x1, y1); t2 = <span class="built_in">cal</span>(x2, y2);</span><br><span class="line">    <span class="keyword">if</span> (t1 &gt; t2) &#123;</span><br><span class="line">        lx = x1, ly = y1;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        rx = x2, ry = y2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="随机增量"><a href="#随机增量" class="headerlink" title="随机增量"></a>随机增量</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e5</span><span class="number">+100</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">double</span> x, y;</span><br><span class="line">    node <span class="keyword">operator</span>+(node a) &#123;<span class="keyword">return</span> (node)&#123;(a.x+x)/<span class="number">2</span>, (a.y+y)/<span class="number">2</span>&#125;;&#125;</span><br><span class="line">    node <span class="keyword">operator</span>-(node a) &#123;<span class="keyword">return</span> (node)&#123;x-a.x, y-a.y&#125;;&#125;</span><br><span class="line">    node <span class="keyword">operator</span>/(<span class="type">double</span> a) &#123;<span class="keyword">return</span> (node)&#123;x/a, y/a&#125;;&#125;</span><br><span class="line">    <span class="function">node <span class="title">rev</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> (node) &#123;y, -x&#125;;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">node p[maxn];</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">dis</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>((a.x-b.x)*(a.x-b.x) + (a.y-b.y)*(a.y-b.y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">center</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (node) &#123;(a.x+b.x)/<span class="number">2</span>, (a.y+b.y)/<span class="number">2</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">sqr</span><span class="params">(<span class="type">double</span> a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">cal</span><span class="params">(<span class="type">double</span> x, <span class="type">double</span> y, <span class="type">double</span> z, <span class="type">double</span> u, <span class="type">double</span> v, <span class="type">double</span> w)</span> </span>&#123;</span><br><span class="line">    node t;</span><br><span class="line">    t.x = (z*v-w*y)/(x*v-u*y); t.y = (z-t.x*x)/y;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">center</span><span class="params">(node a, node b, node c)</span> </span>&#123;</span><br><span class="line">    <span class="type">double</span> a1, a2, b1, b2, c1, c2;</span><br><span class="line">    node ans;</span><br><span class="line">    a1=<span class="number">2</span>*(b.x-a.x),b1=<span class="number">2</span>*(b.y-a.y),c1=<span class="built_in">sqr</span>(b.x)-<span class="built_in">sqr</span>(a.x)+<span class="built_in">sqr</span>(b.y)-<span class="built_in">sqr</span>(a.y);</span><br><span class="line">    a2=<span class="number">2</span>*(c.x-a.x),b2=<span class="number">2</span>*(c.y-a.y),c2=<span class="built_in">sqr</span>(c.x)-<span class="built_in">sqr</span>(a.x)+<span class="built_in">sqr</span>(c.y)-<span class="built_in">sqr</span>(a.y);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">fabs</span>(a1) &lt; eps) &#123;</span><br><span class="line">        ans.y=c1/b1;</span><br><span class="line">        ans.x=(c2-ans.y*b2)/a2;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">fabs</span>(b1) &lt; eps) &#123;</span><br><span class="line">        ans.x=c1/a1;</span><br><span class="line">        ans.y=(c2-ans.x*a2)/b2;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ans.x=(c2*b1-c1*b2)/(a2*b1-a1*b2);</span><br><span class="line">        ans.y=(c2*a1-c1*a2)/(b2*a1-b1*a2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>, &amp;p[i].x, &amp;p[i].y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">random_shuffle</span>(p<span class="number">+1</span>, p<span class="number">+1</span>+n);</span><br><span class="line">    node o = p[<span class="number">1</span>];</span><br><span class="line">    <span class="type">double</span> r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) <span class="keyword">if</span> (<span class="built_in">dis</span>(o, p[i]) &gt; r + eps) &#123;</span><br><span class="line">        o = <span class="built_in">center</span>(p[<span class="number">1</span>], p[i]); r = <span class="built_in">dis</span>(o, p[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; i; j++) <span class="keyword">if</span> (<span class="built_in">dis</span>(o, p[j]) &gt; r + eps)&#123;</span><br><span class="line">            o = <span class="built_in">center</span>(p[i], p[j]); r = <span class="built_in">dis</span>(o, p[j]);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt; j; k++) <span class="keyword">if</span> (<span class="built_in">dis</span>(o, p[k]) &gt; r + eps) &#123;</span><br><span class="line">                o = <span class="built_in">center</span>(p[i], p[j], p[k]); r = <span class="built_in">dis</span>(o, p[k]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.10f\n%.10f %.10f&quot;</span>, r, o.x, o.y);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="高斯消元"><a href="#高斯消元" class="headerlink" title="高斯消元"></a>高斯消元</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1700</span>;</span><br><span class="line"><span class="type">int</span> a[maxn][maxn];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> var, equ;</span><br><span class="line"><span class="type">int</span> ans[<span class="number">1700</span>];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; free_x;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">g</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> mxr, col, k;</span><br><span class="line">    <span class="keyword">for</span> (k=<span class="number">0</span>, col=<span class="number">0</span>; k&lt;equ &amp;&amp; col&lt;equ; k++, col++) &#123;</span><br><span class="line">        mxr=k;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=k<span class="number">+1</span>; i&lt;equ; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">abs</span>(a[mxr][col])&lt;<span class="built_in">abs</span>(a[i][col])) mxr=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (a[mxr][col]==<span class="number">0</span>) &#123;</span><br><span class="line">            free_x.<span class="built_in">push_back</span>(col), k--;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (mxr!=k) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=col; j&lt;var<span class="number">+1</span>; j++) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(a[mxr][j], a[k][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=k<span class="number">+1</span>; i&lt;equ; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i][col]!=<span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j=col; j&lt;var<span class="number">+1</span>; j++) &#123;</span><br><span class="line">                    a[i][j]^=a[k][j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=k; i&lt;equ; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i][col]!=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (k&lt;var) <span class="keyword">return</span> var-k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=var<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) &#123;</span><br><span class="line">        ans[i]=a[i][var];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j=i<span class="number">+1</span>; j&lt;var; j++) &#123;</span><br><span class="line">            ans[i]^=(a[i][j]&amp;&amp;ans[j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    equ=m*n, var=m*n;</span><br><span class="line">    free_x.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="comment">// for (int i=0; i&lt;=equ; i++) a[i].reset();</span></span><br><span class="line">    <span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="built_in">sizeof</span>(ans));</span><br><span class="line">    <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>; j&lt;m; j++) &#123;</span><br><span class="line">            <span class="type">int</span> t=i*m+j;</span><br><span class="line">            a[t][t]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i&gt;<span class="number">0</span>) a[(i<span class="number">-1</span>)*m+j][t]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i&lt;n<span class="number">-1</span>) a[(i<span class="number">+1</span>)*m+j][t]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (j&gt;<span class="number">0</span>) a[i*m+j<span class="number">-1</span>][t]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (j&lt;m<span class="number">-1</span>) a[i*m+j<span class="number">+1</span>][t]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="倍增求lca"><a href="#倍增求lca" class="headerlink" title="倍增求lca"></a>倍增求lca</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> f[maxn][<span class="number">20</span>];</span><br><span class="line"><span class="type">int</span> dep[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> dept, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">    f[u][<span class="number">0</span>] = fa;</span><br><span class="line">    dep[u] = dept;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[u][i<span class="number">-1</span>] &lt; <span class="number">0</span>) f[u][i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">else</span> f[u][i] = f[f[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="type">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (to == fa) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(to, dept + <span class="number">1</span>, u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[a] &lt; dep[b]) <span class="built_in">swap</span>(a, b);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, d = dep[a] - dep[b]; d; i++, d &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (d &amp; <span class="number">1</span>) a = f[a][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a == b) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="built_in">log</span>(n) + <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[a][i] != f[b][i]) a = f[a][i], b = f[b][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[a][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="On求图上所有点的最远点对"><a href="#On求图上所有点的最远点对" class="headerlink" title="On求图上所有点的最远点对"></a>On求图上所有点的最远点对</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">2e5</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> u, w, nxt;</span><br><span class="line">&#125;v[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node2</span> &#123;</span><br><span class="line">    <span class="type">int</span> pos;</span><br><span class="line">    ll dis;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> node2&amp; tmp) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dis &gt; tmp.dis;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;da[maxn][<span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> n, m, cnt = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> head[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span> </span>&#123;</span><br><span class="line">    v[cnt] = (node) &#123;b, c, head[a]&#125;; head[a] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="type">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (to == fa) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(to, u);</span><br><span class="line">        da[u][<span class="number">3</span>].dis = da[to][<span class="number">0</span>].dis + v[i].w, da[u][<span class="number">3</span>].pos = to;</span><br><span class="line">        <span class="built_in">sort</span>(da[u], da[u] + <span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="built_in">max</span>(ans, da[u][<span class="number">0</span>].dis + da[u][<span class="number">1</span>].dis * <span class="number">2</span> + da[u][<span class="number">2</span>].dis);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> vis[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="type">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (!vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (u != da[to][<span class="number">0</span>].pos) da[u][<span class="number">3</span>].dis = da[to][<span class="number">0</span>].dis + v[i].w;</span><br><span class="line">        <span class="keyword">else</span> da[u][<span class="number">3</span>].dis = da[to][<span class="number">1</span>].dis + v[i].w;</span><br><span class="line">        da[u][<span class="number">3</span>].pos = to;</span><br><span class="line">        <span class="built_in">sort</span>(da[u], da[u] + <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="built_in">max</span>(ans, da[u][<span class="number">0</span>].dis + da[u][<span class="number">1</span>].dis * <span class="number">2</span> + da[u][<span class="number">2</span>].dis);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="type">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (!vis[to]) <span class="built_in">dfs2</span>(to);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="树上主席树"><a href="#树上主席树" class="headerlink" title="树上主席树"></a>树上主席树</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e5</span> + <span class="number">100</span>;</span><br><span class="line"><span class="type">int</span> da[maxn], ranks[maxn];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> l, r, sum;</span><br><span class="line">&#125; tr[maxn*<span class="number">20</span>];</span><br><span class="line"><span class="type">int</span> root[maxn];</span><br><span class="line"><span class="type">int</span> Tcnt, total;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> num, <span class="type">int</span>&amp; x, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    tr[++Tcnt] = tr[x]; x = Tcnt; tr[x].sum++;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (num &lt;= mid) <span class="built_in">ins</span>(num, tr[x].l, l, mid);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">ins</span>(num, tr[x].r, mid<span class="number">+1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> ss, <span class="type">int</span> bs, <span class="type">int</span> k, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="type">int</span> d = tr[tr[bs].l].sum - tr[tr[ss].l].sum;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (k &lt;= d) <span class="keyword">return</span> <span class="built_in">query</span>(tr[ss].l, tr[bs].l, k, l, mid);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(tr[ss].r, tr[bs].r, k - d, mid<span class="number">+1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> f[maxn][<span class="number">20</span>], dep[maxn];</span><br><span class="line"><span class="type">int</span> head[maxn], to[maxn&lt;&lt;<span class="number">1</span>], nxt[maxn&lt;&lt;<span class="number">1</span>], vcnt;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    to[++vcnt] = b; nxt[vcnt] = head[a]; head[a] = vcnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> dept)</span> </span>&#123;</span><br><span class="line">    dep[u] = dept;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!f[u][i<span class="number">-1</span>]) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span> f[u][i] = f[f[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">ins</span>(ranks[u], root[u] = root[f[u][<span class="number">0</span>]], <span class="number">1</span>, total);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (to[i] == f[u][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">        f[to[i]][<span class="number">0</span>] = u;</span><br><span class="line">        <span class="built_in">dfs</span>(to[i], dept<span class="number">+1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> logs[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[a] &lt; dep[b]) <span class="built_in">swap</span>(a, b);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, d = dep[a] - dep[b]; d; d&gt;&gt;=<span class="number">1</span>, i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (d&amp;<span class="number">1</span>) a = f[a][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a == b) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = logs[n]; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[a][i] != f[b][i]) a = f[a][i], b = f[b][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[a][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query2</span><span class="params">(<span class="type">int</span> ss1, <span class="type">int</span> ss2, <span class="type">int</span> bs1, <span class="type">int</span> bs2, <span class="type">int</span> k, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l; <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> d = tr[tr[bs1].l].sum + tr[tr[bs2].l].sum - tr[tr[ss1].l].sum - tr[tr[ss2].l].sum;</span><br><span class="line">    <span class="keyword">if</span> (k &lt;= d) <span class="keyword">return</span> <span class="built_in">query2</span>(tr[ss1].l, tr[ss2].l, tr[bs1].l, tr[bs2].l, k, l, mid);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query2</span>(tr[ss1].r, tr[ss2].r, tr[bs1].r, tr[bs2].r, k - d, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="type">int</span> da2[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> m; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, tmp; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;tmp);</span><br><span class="line">        da[i] = tmp; da2[i] =  tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(da2 + <span class="number">1</span>, da2 + <span class="number">1</span> + n);</span><br><span class="line">    logs[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; maxn; i++) logs[i] = logs[i&gt;&gt;<span class="number">1</span>]<span class="number">+1</span>;</span><br><span class="line">    total = <span class="built_in">unique</span>(da2 + <span class="number">1</span>, da2 + <span class="number">1</span> + n) - da2 - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) ranks[i] = <span class="built_in">lower_bound</span>(da2 + <span class="number">1</span>, da2 + <span class="number">1</span> + total, da[i]) - da2;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, a, b; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b); <span class="built_in">add</span>(a, b); <span class="built_in">add</span>(b, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, a, b, k, t;</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;k);</span><br><span class="line">        a ^= ans; t = <span class="built_in">lca</span>(a, b);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans = da2[<span class="built_in">query2</span>(root[t], root[f[t][<span class="number">0</span>]], root[a], root[b], k, <span class="number">1</span>, total)]);</span><br><span class="line">        <span class="keyword">if</span> (m) <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="树剖"><a href="#树剖" class="headerlink" title="树剖"></a>树剖</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">3e5</span><span class="number">+100</span>;</span><br><span class="line"><span class="type">int</span> head[maxn], to[maxn&lt;&lt;<span class="number">1</span>], nxt[maxn&lt;&lt;<span class="number">1</span>], vcnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    to[++vcnt] = b; nxt[vcnt] = head[a]; head[a] = vcnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> son[maxn], sz[maxn], dep[maxn], fa[maxn];</span><br><span class="line"><span class="type">int</span> sum[maxn], id[maxn], top[maxn], idd;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    fa[u] = f; sz[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (to[i] == f) <span class="keyword">continue</span>;</span><br><span class="line">        dep[to[i]] = dep[u] + <span class="number">1</span>; <span class="built_in">dfs1</span>(to[i], u);</span><br><span class="line">        sz[u] += sz[to[i]];</span><br><span class="line">        <span class="keyword">if</span> (sz[to[i]] &gt; sz[son[u]]) son[u] = to[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> tp)</span> </span>&#123;</span><br><span class="line">    top[u] = tp; id[u] = ++idd;</span><br><span class="line">    <span class="keyword">if</span> (son[u])</span><br><span class="line">        <span class="built_in">dfs2</span>(son[u], tp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (to[i] != fa[u] &amp;&amp; to[i] != son[u])</span><br><span class="line">            <span class="built_in">dfs2</span>(to[i], to[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (top[x] != top[y]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[x]] &lt; dep[top[y]]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">        sum[id[top[x]]]++, sum[id[x] + <span class="number">1</span>]--; <span class="comment">// 区间覆盖</span></span><br><span class="line">        x = fa[top[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &gt; dep[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">    sum[id[x]]++, sum[id[y] + <span class="number">1</span>]--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> da[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, da + i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, a, b; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">add</span>(a, b); <span class="built_in">add</span>(b, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">-1</span>); <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) <span class="built_in">update</span>(da[i], da[i + <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) sum[i] += sum[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == da[<span class="number">1</span>]) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum[id[i]]);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum[id[i]] - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="模拟退火"><a href="#模拟退火" class="headerlink" title="模拟退火"></a>模拟退火</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> minn = <span class="number">99999999999999999LL</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">double</span> <span class="title">dis</span><span class="params">(node&amp; a, node&amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">double</span> <span class="title">rands</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">rand</span>() % <span class="number">1000</span>) / <span class="number">1000.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">double</span> <span class="title">judge</span><span class="params">(node&amp; now)</span> </span>&#123;</span><br><span class="line">    <span class="type">double</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) res += <span class="built_in">dis</span>(da[i], now) * da[i].p;</span><br><span class="line">    <span class="keyword">if</span> (res &lt; minn) minn = res, ans = now;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">double</span> T = <span class="number">1e5</span>, dE;</span><br><span class="line">    node now = ans, ne;</span><br><span class="line">    <span class="keyword">while</span>(T &gt; <span class="number">1e-3</span>)&#123;</span><br><span class="line">        ne.x = now.x + T * (<span class="built_in">rands</span>() * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        ne.y = now.y + T * (<span class="built_in">rands</span>() * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        dE = <span class="built_in">judge</span>(now) - <span class="built_in">judge</span>(ne);</span><br><span class="line">        <span class="keyword">if</span> (dE&gt;<span class="number">0</span> || <span class="built_in">exp</span>(dE/T)&gt;<span class="built_in">rands</span>()) now = ne;</span><br><span class="line">        T *= <span class="number">0.99</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">1000</span>; i++) &#123;</span><br><span class="line">        ne.x = ans.x + T * (<span class="built_in">rands</span>() * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        ne.y = ans.y + T * (<span class="built_in">rands</span>() * <span class="number">2</span> - <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">judge</span>(ne);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-sat"><a href="#2-sat" class="headerlink" title="2 sat"></a>2 sat</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A，B不能同时取,连边A→B’，B→A’</span></span><br><span class="line"><span class="comment">// A，B不能同时不取, A’→B，B’→A</span></span><br><span class="line"><span class="comment">// A，B要么都取，要么都不取,A→B，B→A，A’→B’，B’→A’</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e4</span><span class="number">+100</span>;</span><br><span class="line"><span class="type">int</span> head[maxn], to[maxn*<span class="number">100</span>], nxt[maxn*<span class="number">100</span>], cnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    to[cnt] = b, nxt[cnt] = head[a]; head[a] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> ans[maxn];</span><br><span class="line"><span class="type">int</span> dfn[maxn], low[maxn], vis[maxn], ins[maxn], dfns, Amount;</span><br><span class="line"><span class="type">int</span> belong[maxn], cnts[maxn];</span><br><span class="line">stack&lt;<span class="type">int</span>&gt; s;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    vis[u] = ins[u] = <span class="number">1</span>; s.<span class="built_in">push</span>(u);</span><br><span class="line">    dfn[u] = low[u] = dfns++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; ~i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[to[i]]) <span class="built_in">tarjan</span>(to[i]), low[u] = <span class="built_in">min</span>(low[u], low[to[i]]);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ins[to[i]]) low[u] = <span class="built_in">min</span>(low[u], dfn[to[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (dfn[u] == low[u]) &#123;</span><br><span class="line">        Amount++;</span><br><span class="line">        <span class="keyword">while</span> (x != u) &#123;</span><br><span class="line">            x = s.<span class="built_in">top</span>(); s.<span class="built_in">pop</span>(); ins[x] = <span class="number">0</span>;</span><br><span class="line">            belong[x] = Amount; cnts[Amount]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> another[maxn], color[maxn], ind[maxn];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; mp2[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tp</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) mp2[i].<span class="built_in">clear</span>();</span><br><span class="line">    <span class="built_in">memset</span>(color, <span class="number">0</span>, <span class="built_in">sizeof</span>(color));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=(n&lt;&lt;<span class="number">1</span>); i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j=head[i]; ~j; j=nxt[j]) &#123;</span><br><span class="line">            <span class="type">int</span> t=to[j];</span><br><span class="line">            <span class="keyword">if</span> (belong[i]!=belong[t]) &#123;</span><br><span class="line">                mp2[belong[t]].<span class="built_in">push_back</span>(belong[i]);</span><br><span class="line">                ind[belong[i]]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">        another[belong[i]]=belong[i+n];</span><br><span class="line">        another[belong[i+n]]=belong[i];</span><br><span class="line">    &#125;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=Amount; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ind[i]==<span class="number">0</span>) q.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> nw; !q.<span class="built_in">empty</span>(); q.<span class="built_in">pop</span>()) &#123;</span><br><span class="line">        nw=q.<span class="built_in">front</span>();</span><br><span class="line">        <span class="keyword">if</span> (color[nw]==<span class="number">0</span>) &#123;</span><br><span class="line">            color[nw]=<span class="string">&#x27;R&#x27;</span>; color[another[nw]]=<span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> t:mp2[nw]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!(--ind[t])) &#123;</span><br><span class="line">                q.<span class="built_in">push</span>(t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">memset</span>(dfn, <span class="number">0</span>, <span class="built_in">sizeof</span>(dfn));</span><br><span class="line">    <span class="built_in">memset</span>(low, <span class="number">0</span>, <span class="built_in">sizeof</span>(low));</span><br><span class="line">    <span class="built_in">memset</span>(belong, <span class="number">0</span>, <span class="built_in">sizeof</span>(belong));</span><br><span class="line">    <span class="keyword">while</span> (!s.<span class="built_in">empty</span>()) ins[s.<span class="built_in">top</span>()] = <span class="number">0</span>, s.<span class="built_in">pop</span>();</span><br><span class="line">    Amount = cnt = dfns = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> s1[<span class="number">10</span>], s2[<span class="number">10</span>], s3[<span class="number">10</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;in.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;out.txt&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="type">int</span> n, k; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;k, &amp;n);</span><br><span class="line">    <span class="comment">// for (int i=1; i&lt;=k; i++) add(i, i+k), add(i+k, i);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>, a, b, c, _a, _b, _c; i&lt;n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%s%d%s%d%s&quot;</span>, &amp;a, s1, &amp;b, s2, &amp;c, s3);</span><br><span class="line">        <span class="keyword">if</span> (s1[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) _a=a+k; <span class="keyword">else</span> _a=a, a+=k;</span><br><span class="line">        <span class="keyword">if</span> (s2[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) _b=b+k; <span class="keyword">else</span> _b=b, b+=k;</span><br><span class="line">        <span class="keyword">if</span> (s3[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) _c=c+k; <span class="keyword">else</span> _c=c, c+=k;</span><br><span class="line">        <span class="built_in">add</span>(_a, b); <span class="built_in">add</span>(_a, c);</span><br><span class="line">        <span class="built_in">add</span>(_b, a); <span class="built_in">add</span>(_b, c);</span><br><span class="line">        <span class="built_in">add</span>(_c, a); <span class="built_in">add</span>(_c, b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=(k&lt;&lt;<span class="number">1</span>); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i]) <span class="built_in">tarjan</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> flag=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (belong[i]==belong[i+k]) &#123;</span><br><span class="line">            flag=<span class="literal">true</span>; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">tp</span>(k);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k*<span class="number">2</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (color[belong[i]]==<span class="string">&#x27;R&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i&lt;=k) ans[i]=<span class="string">&#x27;R&#x27;</span>;</span><br><span class="line">                <span class="keyword">else</span> ans[i-k]=<span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// printf(&quot;%c&quot;, color[belong[i]]);</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++) <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e4</span><span class="number">+100</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; mp[maxn];</span><br><span class="line"><span class="type">bool</span> vis[maxn];</span><br><span class="line">stack&lt;<span class="type">int</span>&gt; s;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (vis[x^<span class="number">1</span>]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (vis[x]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    vis[x]=<span class="number">1</span>; s.<span class="built_in">push</span>(x);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> t:mp[x]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">dfs</span>(t)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">twoSat</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i+=<span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[i] || vis[i^<span class="number">1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span> (s.<span class="built_in">size</span>()) s.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">dfs</span>(i)) &#123;</span><br><span class="line">            <span class="keyword">while</span> (s.<span class="built_in">size</span>()) vis[s.<span class="built_in">top</span>()]=<span class="literal">false</span>, s.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">dfs</span>(i^<span class="number">1</span>)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> s1[<span class="number">10</span>], s2[<span class="number">10</span>], s3[<span class="number">10</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, k; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;k, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>, a, b, c, _a, _b, _c; i&lt;n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%s%d%s%d%s&quot;</span>, &amp;a, s1, &amp;b, s2, &amp;c, s3);</span><br><span class="line">        a--; a&lt;&lt;=<span class="number">1</span>; <span class="keyword">if</span> (s1[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) _a=a^<span class="number">1</span>; <span class="keyword">else</span> _a=a, a^=<span class="number">1</span>;</span><br><span class="line">        b--; b&lt;&lt;=<span class="number">1</span>; <span class="keyword">if</span> (s2[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) _b=b^<span class="number">1</span>; <span class="keyword">else</span> _b=b, b^=<span class="number">1</span>;</span><br><span class="line">        c--; c&lt;&lt;=<span class="number">1</span>; <span class="keyword">if</span> (s3[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) _c=c^<span class="number">1</span>; <span class="keyword">else</span> _c=c, c^=<span class="number">1</span>;</span><br><span class="line">        mp[_a].<span class="built_in">push_back</span>(b); mp[_a].<span class="built_in">push_back</span>(c);</span><br><span class="line">        mp[_b].<span class="built_in">push_back</span>(a); mp[_b].<span class="built_in">push_back</span>(c);</span><br><span class="line">        mp[_c].<span class="built_in">push_back</span>(a); mp[_c].<span class="built_in">push_back</span>(b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">twoSat</span>(k*<span class="number">2</span>)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>*k; i+=<span class="number">2</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="string">&quot;BR&quot;</span>[vis[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="tarjan缩点"><a href="#tarjan缩点" class="headerlink" title="tarjan缩点"></a>tarjan缩点</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = head[i]; j; j = nxt[j]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (belong[i] != belong[to[j]] &amp;&amp; !vis[to[j]]) &#123;</span><br><span class="line">            <span class="built_in">Add</span>(belong[i], belong[to[j]]);</span><br><span class="line">            in[belong[to[j]]]++; vis[belong[to[j]]] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = head[i]; j; j = nxt[j]) &#123;</span><br><span class="line">        vis[belong[to[j]]] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="点分"><a href="#点分" class="headerlink" title="点分"></a>点分</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">2e4</span> + <span class="number">100</span>;</span><br><span class="line"><span class="type">int</span> head[maxn];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> u, w, nxt;</span><br><span class="line">&#125; v[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span> </span>&#123;</span><br><span class="line">    v[++cnt] = (node) &#123;b, c, head[a]&#125;; head[a] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> vis[maxn];</span><br><span class="line"><span class="type">int</span> son[maxn], mSon[maxn], root;</span><br><span class="line"><span class="type">int</span> n, sum;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getRt</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">    son[x] = <span class="number">1</span>, mSon[x] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[x]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="type">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (vis[to] || to == fa) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getRt</span>(to, x);</span><br><span class="line">        son[x] += son[to];</span><br><span class="line">        mSon[x] = <span class="built_in">max</span>(mSon[x], son[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    mSon[x] = <span class="built_in">max</span>(mSon[x], sum - son[x]);</span><br><span class="line">    <span class="keyword">if</span> (mSon[x] &lt; mSon[root]) root = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> dep[maxn], ct[<span class="number">10</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getDep</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">    ct[dep[u]]++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="type">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (to == fa || vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        dep[to] = (dep[u] + v[i].w) % <span class="number">3</span>;</span><br><span class="line">        <span class="built_in">getDep</span>(to, u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cal</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> now)</span> </span>&#123;</span><br><span class="line">    ct[<span class="number">0</span>] = ct[<span class="number">1</span>] = ct[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    dep[x] = now; <span class="built_in">getDep</span>(x, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> ct[<span class="number">0</span>] * ct[<span class="number">0</span>] + ct[<span class="number">1</span>] * ct[<span class="number">2</span>] * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    ans += <span class="built_in">cal</span>(x, <span class="number">0</span>); vis[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[x]; i; i = v[i].nxt) &#123;</span><br><span class="line">        <span class="type">int</span> to = v[i].u;</span><br><span class="line">        <span class="keyword">if</span> (vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        ans -= <span class="built_in">cal</span>(to, v[i].w);</span><br><span class="line">        root = <span class="number">0</span>; sum = son[to]; <span class="built_in">getRt</span>(to, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">solve</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, a, b, c; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c); c %= <span class="number">3</span>;</span><br><span class="line">        <span class="built_in">add</span>(a, b, c); <span class="built_in">add</span>(b, a, c);</span><br><span class="line">    &#125;</span><br><span class="line">    mSon[<span class="number">0</span>] = inf; sum = n;</span><br><span class="line">    <span class="built_in">getRt</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">solve</span>(root);</span><br><span class="line">    <span class="type">int</span> gcd = __gcd(ans, n * n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d/%d\n&quot;</span>, ans / gcd, n * n / gcd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="匈牙利算法"><a href="#匈牙利算法" class="headerlink" title="匈牙利算法"></a>匈牙利算法</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 二分图最大独立集(点数-最大匹配数)</span></span><br><span class="line"><span class="type">bool</span> vis[<span class="number">10101</span>];</span><br><span class="line"><span class="type">int</span> fa[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (vis[u]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!fa[to[i]] || <span class="built_in">dfs</span>(fa[to[i]])) &#123;</span><br><span class="line">            fa[to[i]] = u;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">    ans+=<span class="built_in">dfs</span>(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="极角排序-叉积"><a href="#极角排序-叉积" class="headerlink" title="极角排序+叉积"></a>极角排序+叉积</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">4000</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    ll x, y;</span><br><span class="line">&#125;da[maxn], da2[maxn];</span><br><span class="line"><span class="function">ll <span class="title">cal</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.x * b.y - b.x * a.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">cmp1</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cal</span>(a, b) &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">cmp2</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a.y != b.y) <span class="keyword">return</span> a.y &lt; b.y;</span><br><span class="line">    <span class="keyword">return</span> a.x &lt; b.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(lld lld, &amp;da[i].x, &amp;da[i].y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(da<span class="number">+1</span>, da<span class="number">+1</span>+n, cmp2);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        ll sumx = <span class="number">0</span>, sumy = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            sumx += da2[++cnt].x = da[j].x - da[i].x;</span><br><span class="line">            sumy += da2[cnt].y = da[j].y - da[i].y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(da2<span class="number">+1</span>, da2<span class="number">+1</span>+cnt, cmp1);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cnt; j++) &#123;</span><br><span class="line">            sumx -= da2[j].x;</span><br><span class="line">            sumy -= da2[j].y;</span><br><span class="line">            ans += (da2[j].x * sumy - da2[j].y * sumx);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(lld <span class="string">&quot;.&quot;</span> lld, ans&gt;&gt;<span class="number">1</span>, (ans&amp;<span class="number">1</span>)*<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="逆元"><a href="#逆元" class="headerlink" title="逆元"></a>逆元</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(ll a, ll b, ll&amp; d, ll&amp;x, ll&amp; y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        d = a, x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">exgcd</span>(b, a%b, d, y, x);</span><br><span class="line">        y -= x * (a / b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll a, ll mod)</span> </span>&#123;</span><br><span class="line">    ll x, y, d;</span><br><span class="line">    <span class="built_in">exgcd</span>(a, mod, d, x, y);</span><br><span class="line">    <span class="keyword">return</span> (x%mod+mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 线性求逆元</span></span><br><span class="line">ll invs[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getInv</span><span class="params">(<span class="type">int</span> mod)</span> </span>&#123;</span><br><span class="line">    invs[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; maxn; i++) &#123;</span><br><span class="line">        invs[i] = <span class="number">1LL</span> * invs[mod%i] * (mod-mod/i) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="矩阵快速幂"><a href="#矩阵快速幂" class="headerlink" title="矩阵快速幂"></a>矩阵快速幂</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e6</span><span class="number">+100</span>;</span><br><span class="line">ll mod;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">mat</span> &#123;</span><br><span class="line">    ll a[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">    <span class="built_in">mat</span>()&#123;<span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));&#125;</span><br><span class="line">    mat <span class="keyword">operator</span>* (<span class="type">const</span> mat&amp; A) <span class="type">const</span> &#123;</span><br><span class="line">        mat ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>; j&lt;<span class="number">2</span>; j++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k=<span class="number">0</span>; k&lt;<span class="number">2</span>; k++)</span><br><span class="line">                    ans.a[i][j]+=a[i][k]*A.a[k][j]%mod;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>; i++) a[i][i]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> mat <span class="title">qpow</span><span class="params">(mat A, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    mat ans; ans.<span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span> (; b; b&gt;&gt;=<span class="number">1</span>, A=A*A) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>) ans=ans*A;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">mat <span class="title">qpow</span><span class="params">(mat A, <span class="type">char</span>* b, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    mat ans; ans.<span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=len; i; i--) &#123;</span><br><span class="line">        <span class="type">int</span> cnt=b[i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ans=ans*<span class="built_in">qpow</span>(A, cnt);</span><br><span class="line">        A=<span class="built_in">qpow</span>(A, <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> s[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll x0, x1, a, b;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld%s%lld&quot;</span>, &amp;x0, &amp;x1, &amp;a, &amp;b, s<span class="number">+1</span>, &amp;mod);</span><br><span class="line">    <span class="type">int</span> len=<span class="built_in">strlen</span>(s<span class="number">+1</span>);</span><br><span class="line">    s[len]--;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=len; s[i]&lt;<span class="string">&#x27;0&#x27;</span> &amp;&amp; i; i--) s[i<span class="number">-1</span>]--, s[i]+=<span class="number">10</span>;</span><br><span class="line">    mat A; A.a[<span class="number">0</span>][<span class="number">0</span>]=a; A.a[<span class="number">0</span>][<span class="number">1</span>]=b; A.a[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">1</span>; A.a[<span class="number">1</span>][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    A=<span class="built_in">qpow</span>(A, s, len);</span><br><span class="line">    ll ans=(A.a[<span class="number">0</span>][<span class="number">0</span>]*x1%mod+A.a[<span class="number">0</span>][<span class="number">1</span>]*x0%mod)%mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="dinic"><a href="#dinic" class="headerlink" title="dinic"></a>dinic</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">6e4</span>;</span><br><span class="line"><span class="type">int</span> head[maxn], to[maxn&lt;&lt;<span class="number">6</span>], nxt[maxn&lt;&lt;<span class="number">6</span>], w[maxn&lt;&lt;<span class="number">6</span>], vcnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span> </span>&#123;</span><br><span class="line">    to[vcnt] = b; w[vcnt] = c; nxt[vcnt] = head[a]; head[a] = vcnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> start, stop;</span><br><span class="line"><span class="type">int</span> dep[maxn];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dep, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dep));</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q; q.<span class="built_in">push</span>(start);</span><br><span class="line">    dep[start] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="type">int</span> x = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = head[x]; ~i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (w[i] &amp;&amp; dep[to[i]] == <span class="number">-1</span>) &#123;</span><br><span class="line">                q.<span class="built_in">push</span>(to[i]);</span><br><span class="line">                dep[to[i]] = dep[x] + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[stop] != <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u == stop) <span class="keyword">return</span> flow;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; ~i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="type">int</span> t = to[i];</span><br><span class="line">        <span class="keyword">if</span> (w[i] &amp;&amp; dep[t] == dep[u] + <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> f = <span class="built_in">dfs</span>(t, <span class="built_in">min</span>(flow, w[i]));</span><br><span class="line">            flow -= f; w[i] -= f; w[i^<span class="number">1</span>] += f;</span><br><span class="line">            res += f;</span><br><span class="line">            <span class="keyword">if</span> (!flow) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!res) dep[u] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dinic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">bfs</span>()) &#123;</span><br><span class="line">        ans += <span class="built_in">dfs</span>(start, inf);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(head));</span><br><span class="line">    vcnt = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="spfa-费用流"><a href="#spfa-费用流" class="headerlink" title="spfa 费用流"></a>spfa 费用流</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">2000</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">3000100</span>;</span><br><span class="line"><span class="type">int</span> start, stop;</span><br><span class="line"><span class="type">int</span> head[maxn], nxt[maxm], to[maxm], f[maxm], w[maxm], fr[maxm], vcnt;</span><br><span class="line"><span class="type">void</span> _add(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> ww) &#123;</span><br><span class="line">    to[vcnt]=b; f[vcnt]=c; w[vcnt]=ww; nxt[vcnt]=head[a]; fr[vcnt] = a; head[a]=vcnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> ww)</span> </span>&#123;</span><br><span class="line">    _add(a, b, c, ww);</span><br><span class="line">    _add(b, a, <span class="number">0</span>, -ww);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> dis[maxn], from[maxn];</span><br><span class="line"><span class="type">bool</span> inq[maxn];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    <span class="built_in">memset</span>(inq, <span class="number">0</span>, <span class="built_in">sizeof</span>(inq));</span><br><span class="line">    deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push_back</span>(<span class="number">0</span>); dis[<span class="number">0</span>]=<span class="number">0</span>; inq[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="type">int</span> x = q.<span class="built_in">front</span>(); q.<span class="built_in">pop_front</span>(); inq[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=head[x]; ~i; i=nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (f[i] &amp;&amp; dis[to[i]] &gt; dis[x]+w[i]) &#123;</span><br><span class="line">                dis[to[i]] = dis[x] + w[i];</span><br><span class="line">                from[to[i]] = i;</span><br><span class="line">                <span class="keyword">if</span> (!inq[to[i]]) &#123;</span><br><span class="line">                    inq[to[i]] = <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (q.<span class="built_in">size</span>() &amp;&amp; dis[to[i]] &lt; dis[q.<span class="built_in">front</span>()]) &#123;</span><br><span class="line">                        q.<span class="built_in">push_front</span>(to[i]);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        q.<span class="built_in">push_back</span>(to[i]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dis[stop] != inf;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mcf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> x = inf;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = stop; i; i=fr[from[i]]) &#123;</span><br><span class="line">        x = <span class="built_in">min</span>(x, f[from[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = stop; i; i=fr[from[i]]) &#123;</span><br><span class="line">        ans += x * w[from[i]];</span><br><span class="line">        f[from[i]] -= x; f[from[i]^<span class="number">1</span>] += x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">spfa</span>())&#123;</span><br><span class="line">    <span class="built_in">mcf</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="线性基"><a href="#线性基" class="headerlink" title="线性基"></a>线性基</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">64</span>; ~j; j--) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((da[i].x&gt;&gt;j)&amp;<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p[j]) da[i].x^=p[j];</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                p[j]=da[i].x; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="线性基的交"><a href="#线性基的交" class="headerlink" title="线性基的交"></a>线性基的交</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">uint x[<span class="number">32</span>], y[<span class="number">32</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> rt, <span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) x[i]=y[i]=tr[a][i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;</span><br><span class="line">        uint u=tr[b][i], k=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (!u) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">31</span>; ~j; j--) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((u&gt;&gt;j)&amp;<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (x[j]) u^=x[j], k^=y[j];</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    x[j]=u, y[j]=k; <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!u) <span class="built_in">ins</span>(tr[rt], k);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rope"><a href="#rope" class="headerlink" title="rope"></a>rope</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">2e6</span><span class="number">+100</span>;</span><br><span class="line"><span class="type">char</span> str1[maxn], str2[maxn];</span><br><span class="line">rope&lt;<span class="type">char</span>&gt; da, revda, tmp;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, x, now=<span class="number">0</span>, len; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="type">char</span> opt[<span class="number">50</span>];</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, opt);</span><br><span class="line">        len=da.<span class="built_in">length</span>();</span><br><span class="line">        <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">&#x27;I&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%*c&quot;</span>, &amp;x);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;x; i++) &#123;</span><br><span class="line">                str1[i]=<span class="built_in">getchar</span>();</span><br><span class="line">                str2[x-i<span class="number">-1</span>]=str1[i];</span><br><span class="line">            &#125;</span><br><span class="line">            str1[x]=str2[x]=<span class="number">0</span>;</span><br><span class="line">            da.<span class="built_in">insert</span>(now, str1);</span><br><span class="line">            revda.<span class="built_in">insert</span>(len-now, str2);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">&#x27;M&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x); now=x;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">&#x27;D&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            da.<span class="built_in">erase</span>(now, x);</span><br><span class="line">            revda.<span class="built_in">erase</span>(len-now-x, x);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            tmp=da.<span class="built_in">substr</span>(now, x);</span><br><span class="line">            da=da.<span class="built_in">substr</span>(<span class="number">0</span>, now)+revda.<span class="built_in">substr</span>(len-now-x, x)+da.<span class="built_in">substr</span>(now+x, len-now-x);</span><br><span class="line">            revda=revda.<span class="built_in">substr</span>(<span class="number">0</span>, len-now-x)+tmp+revda.<span class="built_in">substr</span>(len-now, now);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">&#x27;G&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, da[now]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">&#x27;P&#x27;</span>) &#123;</span><br><span class="line">            now--;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt[<span class="number">0</span>]==<span class="string">&#x27;N&#x27;</span>) &#123;</span><br><span class="line">            now++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="后缀自动机"><a href="#后缀自动机" class="headerlink" title="后缀自动机"></a>后缀自动机</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 广义sam，last置为1，然后插入新串， ed置为串id</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">5e5</span><span class="number">+100</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">sam</span> &#123;</span><br><span class="line"><span class="comment">//点i ii上面表示子串的数量为len[fa[i]]−len[i]</span></span><br><span class="line"><span class="comment">//在parents上，父亲是儿子上的子串的公共后缀</span></span><br><span class="line"><span class="comment">//父亲上的子串出现次数，是儿子上的子串出现次数之和</span></span><br><span class="line"><span class="comment">//在一个点上的子串，短的为长的的后缀</span></span><br><span class="line"><span class="comment">//len数组表示的是这个节上的子串最长长度</span></span><br><span class="line">    <span class="type">int</span> len[maxn&lt;&lt;<span class="number">1</span>], fa[maxn&lt;&lt;<span class="number">1</span>], son[maxn&lt;&lt;<span class="number">1</span>][<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> ed[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line">    <span class="type">int</span> sz, last;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;sz=last=<span class="number">1</span>;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">char</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> s=c-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="type">int</span> p=last, np=++sz;</span><br><span class="line">        last=np; ed[np]=<span class="number">1</span>; len[np]=len[p]<span class="number">+1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; p &amp;&amp; !son[p][s]; p=fa[p]) son[p][s]=np;</span><br><span class="line">        <span class="keyword">if</span> (!p) fa[np]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> q=son[p][s];</span><br><span class="line">            <span class="keyword">if</span> (len[p]<span class="number">+1</span>==len[q]) fa[np]=q;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> nq=++sz; len[nq]=len[p]<span class="number">+1</span>;</span><br><span class="line">                <span class="built_in">memcpy</span>(son[nq], son[q], <span class="built_in">sizeof</span>(son[q]));</span><br><span class="line">                fa[nq]=fa[q]; fa[q]=fa[np]=nq;</span><br><span class="line">                <span class="keyword">for</span> (; q==son[p][s] &amp;&amp; p; p=fa[p]) son[p][s]=nq;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Ins</span><span class="params">(<span class="type">char</span> *str)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; str[i]; i++) &#123;</span><br><span class="line">            <span class="built_in">ins</span>(str[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> x[maxn&lt;&lt;<span class="number">1</span>], y[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">msort</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=sz; i++) x[len[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=sz; i++) x[i]+=x[i<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=sz; i++) y[x[len[i]]--]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ll ans1=<span class="number">1LL</span>*n*(n<span class="number">+1</span>)/<span class="number">2</span>*(n<span class="number">-1</span>), ans2=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=sz; i; i--) &#123;</span><br><span class="line">            <span class="type">int</span> tp = y[i];</span><br><span class="line">            ans2+=<span class="number">1LL</span>*ed[fa[tp]]*len[fa[tp]]*ed[tp];</span><br><span class="line">            ed[fa[tp]]+=ed[tp];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans1-ans2*<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">count</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ll ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">2</span>; i&lt;=sz; i++) ans+=len[i]-len[fa[i]];</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="回文树"><a href="#回文树" class="headerlink" title="回文树"></a>回文树</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fail[i]表示以此节点位结尾，较短的回文串</span></span><br><span class="line"><span class="comment">// num表示以节点i表示的最长回文串的最右端点为回文串结尾的回文串个数</span></span><br><span class="line"><span class="comment">// cnt表示以此节点结尾本质不同的回文串数量，在count()执行后才为正确结果</span></span><br><span class="line"><span class="comment">// 节点数量-2就是本质不同串数量</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">6e5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Pal</span> &#123;</span><br><span class="line">    <span class="type">int</span> nxt[N][<span class="number">26</span>], fail[N], cnt[N], num[N], len[N], S[N], last, n, p;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">newNode</span><span class="params">(<span class="type">int</span> l)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(nxt[p], <span class="number">0</span>, <span class="built_in">sizeof</span>(nxt[p]));</span><br><span class="line">        cnt[p]=num[p]=<span class="number">0</span>; len[p]=l;</span><br><span class="line">        <span class="keyword">return</span> p++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        p=<span class="number">0</span>; <span class="built_in">newNode</span>(<span class="number">0</span>); <span class="built_in">newNode</span>(<span class="number">-1</span>);</span><br><span class="line">        last=<span class="number">0</span>; n=<span class="number">0</span>; fail[<span class="number">0</span>]=<span class="number">1</span>; S[<span class="number">0</span>]=<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getFail</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (; S[n-len[x]<span class="number">-1</span>]!=S[n]; x=fail[x]);</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> c)</span> </span>&#123;</span><br><span class="line">        c-=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        S[++n]=c;</span><br><span class="line">        <span class="type">int</span> cur=<span class="built_in">getFail</span>(last);</span><br><span class="line">        <span class="keyword">if</span> (!nxt[cur][c]) &#123;</span><br><span class="line">            <span class="type">int</span> now=<span class="built_in">newNode</span>(len[cur]<span class="number">+2</span>);</span><br><span class="line">            fail[now]=nxt[<span class="built_in">getFail</span>(fail[cur])][c];</span><br><span class="line">            nxt[cur][c]=now;</span><br><span class="line">            num[now]=num[fail[now]]<span class="number">+1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last=nxt[cur][c];</span><br><span class="line">        cnt[last]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">count</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=p<span class="number">-1</span>; ~i; i--) cnt[fail[i]]+=cnt[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;pal;</span><br></pre></td></tr></table></figure>

<h2 id="支配树"><a href="#支配树" class="headerlink" title="支配树"></a>支配树</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DAG上点对的LCA</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; G[maxn], E[maxn];</span><br><span class="line">    <span class="type">int</span> ind[maxn], dep[maxn];</span><br><span class="line">    <span class="type">int</span> f[maxn][<span class="number">20</span>];</span><br><span class="line">    <span class="type">int</span> n, root, tot, a[maxn];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _n)</span> </span>&#123;</span><br><span class="line">        n=_n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) G[i].<span class="built_in">clear</span>(), ind[i]=<span class="number">0</span>, dep[i]=<span class="number">0</span>, E[i].<span class="built_in">clear</span>();</span><br><span class="line">        root=_n<span class="number">+1</span>; tot=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">        G[a].<span class="built_in">push_back</span>(b); E[b].<span class="built_in">push_back</span>(a);</span><br><span class="line">        ind[a]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">TP</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">if</span> (ind[i]==<span class="number">0</span>) q.<span class="built_in">push</span>(i), E[root].<span class="built_in">push_back</span>(i), G[i].<span class="built_in">push_back</span>(root);</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u=q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">            a[++tot]=u;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> a:E[u])</span><br><span class="line">                <span class="keyword">if</span> ((--ind[a])==<span class="number">0</span>) q.<span class="built_in">push</span>(a);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[a]&gt;dep[b]) <span class="built_in">swap</span>(a, b);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">19</span>; ~i; i--) <span class="keyword">if</span> (dep[b]&gt;dep[a] &amp;&amp; dep[f[b][i]]&gt;=dep[a]) b=f[b][i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">19</span>; ~i; i--) <span class="keyword">if</span> (f[a][i]!=f[b][i]) a=f[a][i], b=f[b][i];</span><br><span class="line">        <span class="keyword">return</span> a==b ? a : f[a][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        dep[root]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">            <span class="type">int</span> u=a[i], fa=<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> v:G[u])</span><br><span class="line">                fa = (fa==<span class="number">-1</span> ? v : <span class="built_in">lca</span>(fa, v));</span><br><span class="line">            dep[u]=dep[fa]<span class="number">+1</span>; f[u][<span class="number">0</span>]=fa;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;<span class="number">20</span>; i++) f[u][i]=f[f[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;T;</span><br></pre></td></tr></table></figure>

<h2 id="二次同余方程"><a href="#二次同余方程" class="headerlink" title="二次同余方程"></a>二次同余方程</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">1e9</span><span class="number">+9</span>;</span><br><span class="line">ll w;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(ll a, ll b, ll&amp; d, ll&amp;x, ll&amp; y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        d = a, x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">exgcd</span>(b, a%b, d, y, x);</span><br><span class="line">        y -= x * (a / b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll a, ll mod)</span> </span>&#123;</span><br><span class="line">    ll x, y, d;</span><br><span class="line">    <span class="built_in">exgcd</span>(a, mod, d, x, y);</span><br><span class="line">    <span class="keyword">return</span> (x%mod+mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a, ll b, ll md)</span> </span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (a%=md; b; b&gt;&gt;=<span class="number">1</span>, a=a*a%md) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>) ans=ans*a%md;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    ll p, d;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">node <span class="title">mul</span><span class="params">(node a, node b, ll md)</span> </span>&#123;</span><br><span class="line">    node ans;</span><br><span class="line">    ans.p=(a.p*b.p%md + a.d*b.d%md*w%md)%md;</span><br><span class="line">    ans.d=(a.p*b.d%md + a.d*b.p%md)%md;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">qpow</span><span class="params">(node a, ll b, ll md)</span> </span>&#123;</span><br><span class="line">    node ans=node&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (; b; b&gt;&gt;=<span class="number">1</span>, a=<span class="built_in">mul</span>(a, a, md)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>) ans=<span class="built_in">mul</span>(ans, a, md);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll x, ll md)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (md==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">qpow</span>(x, (md<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>, md)<span class="number">+1</span>==md) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    ll a, t;</span><br><span class="line">    <span class="keyword">for</span> (a=<span class="number">1</span>; a&lt;md; a++) &#123;</span><br><span class="line">        t=a*a - x;</span><br><span class="line">        w=(t+md)%md;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">qpow</span>(w, (md<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>, md)<span class="number">+1</span>==md) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    node tmp=node&#123;a, <span class="number">1</span>&#125;;</span><br><span class="line">    tmp=<span class="built_in">qpow</span>(tmp, (md<span class="number">+1</span>)&gt;&gt;<span class="number">1</span>, md);</span><br><span class="line">    <span class="keyword">return</span> tmp.p;</span><br><span class="line">    <span class="comment">// sqrt(x)==tmp.p(%mod)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="连分数"><a href="#连分数" class="headerlink" title="连分数"></a>连分数</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a1/b1 &lt;= den/num &lt;= a2/b2</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">continue_frac</span><span class="params">(ll a1, ll b1, ll a2, ll b2, ll&amp; num, ll&amp; den)</span> </span>&#123;</span><br><span class="line">    ll c1=a1/b1, d1=a1%b1;</span><br><span class="line">    ll c2=a2/b2, d2=a2%b2;</span><br><span class="line">    <span class="keyword">if</span> (c1!=c2 || !d1 || !d2) &#123;</span><br><span class="line">        den=<span class="number">1</span>, num=<span class="built_in">min</span>(c1, c2)<span class="number">+1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">continue_frac</span>(b1, d1, b2, d2, den, num);</span><br><span class="line">        num+=c1*den;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SG"><a href="#SG" class="headerlink" title="SG"></a>SG</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">getSg</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> sg[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (sg[n] != <span class="number">-1</span>) <span class="keyword">return</span> sg[n];</span><br><span class="line">    set&lt;<span class="type">int</span>&gt; vis;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> cnt = n / i, res = n % i;</span><br><span class="line">        <span class="keyword">if</span> (cnt % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (res) vis.<span class="built_in">insert</span>(<span class="built_in">getSg</span>(res));</span><br><span class="line">            <span class="keyword">else</span> vis.<span class="built_in">insert</span>(<span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (res)</span><br><span class="line">                vis.<span class="built_in">insert</span>(<span class="built_in">getSg</span>(i) ^ <span class="built_in">getSg</span>(res));</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                vis.<span class="built_in">insert</span>(<span class="built_in">getSg</span>(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; ; i++) <span class="keyword">if</span> (!vis.<span class="built_in">count</span>(i)) <span class="keyword">return</span> sg[n] = i;</span><br><span class="line">&#125;</span><br><span class="line">sg==<span class="number">0</span>,先手必败</span><br></pre></td></tr></table></figure>

<h2 id="输入挂"><a href="#输入挂" class="headerlink" title="输入挂"></a>输入挂</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> buf[<span class="number">100000</span>],*p1=buf,*p2=buf;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">nc</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,<span class="number">100000</span>,stdin),p1==p2)?EOF:*p1++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">rea</span><span class="params">(<span class="type">int</span> &amp; x)</span></span>&#123;</span><br><span class="line">    <span class="type">char</span> c=<span class="built_in">nc</span>();x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(c==EOF) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(c);c=<span class="built_in">nc</span>());</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);x=x*<span class="number">10</span>+c-<span class="string">&#x27;0&#x27;</span>,c=<span class="built_in">nc</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IO &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> maxn=<span class="number">4096</span>;</span><br><span class="line">    <span class="type">char</span> buf[maxn], t[<span class="number">50</span>];</span><br><span class="line">    <span class="type">int</span> bn=maxn, bi=maxn;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">read</span><span class="params">(<span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (bn) &#123;</span><br><span class="line">            <span class="keyword">for</span> (; bi&lt;bn &amp;&amp; buf[bi]&lt;=<span class="string">&#x27; &#x27;</span>; bi++);</span><br><span class="line">            <span class="keyword">if</span> (bi&lt;bn) <span class="keyword">break</span>;</span><br><span class="line">            bn=<span class="built_in">fread</span>(buf, <span class="number">1</span>, maxn, stdin);</span><br><span class="line">            bi=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> sn=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (bn) &#123;</span><br><span class="line">            <span class="keyword">for</span> (; bi&lt;bn &amp;&amp; buf[bi]&gt;<span class="string">&#x27; &#x27;</span>; bi++) s[sn++]=buf[bi];</span><br><span class="line">            <span class="keyword">if</span> (bi&lt;bn) <span class="keyword">break</span>;</span><br><span class="line">            bn=<span class="built_in">fread</span>(buf, <span class="number">1</span>, maxn, stdin);</span><br><span class="line">            bi=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        s[sn]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> sn;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">read</span><span class="params">(<span class="type">int</span>&amp; x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">read</span>(t)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        x=<span class="built_in">atoi</span>(t);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="原根"><a href="#原根" class="headerlink" title="原根"></a>原根</h2><blockquote>
<p>在$(a,m)&#x3D;1$时，定义a对模m的指数 $\delta m(a)$为使$a^d \equiv 1 \pmod{m}$ 成立的最小的正整数d<br>若 $\delta m(a)&#x3D;\varphi(m)$, 则称a是模m的原根<br>素数p的原根个数为 $\varphi(p-1)$<br><strong>指标</strong>:当确定模p和原根g时，定义a的指标为$I(a)$为使$g^d \equiv a \pmod p$成立的最小的正整数d<br>指标性质: $I(ab) \equiv I(a)+I(b) \pmod {p-1}$, $I(a^k) \equiv kI(a) \pmod {p-1}$<br>找$m$的原根：将$\varphi(m)$因数分解，即$\varphi(m)&#x3D;p_1^{k_1}p_2^{k_2}……p_n^{k_n}$如果一个数$g$是模$m$的原根，则其必然满足对于任意一个$1\leq i\leq n, g^{\frac {\varphi(m)} {p_i}}≠1(mod\ m)$  </p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 素数的原根</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e6</span><span class="number">+100</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(ll a, <span class="type">int</span> b, <span class="type">int</span> mod)</span> </span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b&gt;&gt;=<span class="number">1</span>, a=a*a%mod) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>) ans=ans*a%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getG</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line">    <span class="type">int</span> phi=n<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">2</span>; i*i&lt;=phi; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (phi%i==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (phi%i==<span class="number">0</span>) phi/=i;</span><br><span class="line">            p.<span class="built_in">push_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (phi&gt;<span class="number">1</span>) p.<span class="built_in">push_back</span>(phi);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">2</span>; i&lt;n; i++) &#123;</span><br><span class="line">        <span class="type">bool</span> flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j:p) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">qpow</span>(i, (n<span class="number">-1</span>)/j, n)==<span class="number">1</span>) &#123;</span><br><span class="line">                flag=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag) <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> x[maxn], I[maxn];</span><br><span class="line"><span class="type">int</span> cnt[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t; cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> n; t--; ) &#123;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        <span class="built_in">memset</span>(cnt, <span class="number">0</span>, n&lt;&lt;<span class="number">2</span>);</span><br><span class="line">        <span class="type">int</span> g=<span class="built_in">getG</span>(n);</span><br><span class="line">        I[<span class="number">0</span>]=<span class="number">1</span>; x[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++) &#123;</span><br><span class="line">            x[i]=<span class="number">1LL</span>*x[i<span class="number">-1</span>]*g%n;</span><br><span class="line">            I[x[i]]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++) &#123;</span><br><span class="line">            cnt[x[<span class="number">1LL</span>*I[i]*i%(n<span class="number">-1</span>)]]++;</span><br><span class="line">        &#125;</span><br><span class="line">        ll ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i+i&lt;=n; i++) &#123;</span><br><span class="line">            ans+=<span class="number">1LL</span>*cnt[i]*cnt[n-i];</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="蔡勒公式"><a href="#蔡勒公式" class="headerlink" title="蔡勒公式"></a>蔡勒公式</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">getWeek</span><span class="params">(<span class="type">int</span> y, <span class="type">int</span> m, <span class="type">int</span> d)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m&lt;<span class="number">3</span>) m+=<span class="number">12</span>, y--;</span><br><span class="line">    <span class="type">int</span> c=y/<span class="number">100</span>; y%=<span class="number">100</span>;</span><br><span class="line">    <span class="keyword">return</span> ((y+y/<span class="number">4</span>+c/<span class="number">4</span><span class="number">-2</span>*c<span class="number">+26</span>*(m<span class="number">+1</span>)/<span class="number">10</span>+d<span class="number">-1</span>)%<span class="number">7</span><span class="number">+7</span>)%<span class="number">7</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h2><p>$$ {\sum_{m|n}φ(m)}&#x3D;n $$<br>$$ φ^2(n)&#x3D;φ(n^2) $$<br>$$ 1^2+2^2+3^2+…+n^2&#x3D;n(n+1)(2n+1)\div 6 $$<br>$$ 1^3+2^3+3^3+…+n^3&#x3D;n^2(n+1)^2\div 4 $$<br>$$ \sum_{i|n} \mu(i) &#x3D;[n&#x3D;&#x3D;1] $$<br>$$ \sum_i^{n} [{gcd(i,n)&#x3D;1}]&#x3D;n<em>phi(n)\div 2 $$<br>$$ \sum_{i&#x3D;1}^{n}(i</em>[gcd(n, i)&#x3D;1])&#x3D;i*\phi(i)\div 2+[i&#x3D;1] $$<br>$$ F(n)&#x3D;\sum_{d|n}f(d) &#x3D;&gt; f(n)&#x3D;\sum_{d|n}F(d)<em>\mu(\frac{n}{d}) $$<br>$$ lucas(n, m, p) &#x3D; C(n%p, m%p)<em>lucas(n&#x2F;p, m&#x2F;p, p) $$<br>$$ C_n^m % p&#x3D;\prod{C_{n_i}^{m_i}}%p,m&#x3D;\sum{m_ip^i},n&#x3D;\sum{n_ip^i} $$<br>$$ h(n)&#x3D;h(n-1)</em>(4</em>n-2)&#x2F;(n+1) $$<br>$$ h(n)&#x3D;C_{2n}^n&#x2F;(n+1) $$<br>$$ h(n)&#x3D;C_{2n}^n-C_{2n}^{n+1} $$<br>$$ gcd(Fib[a],Fib[b])&#x3D;Fib[gcd(a,b)] $$<br>$$ gcd(a^i-1,a^j-1)&#x3D;a^{gcd(i, j)}-1 $$<br>$$ 球缺：用平面截取球的一部分 $$<br>$$ 球缺面积 &#x3D; 2 \cdot \pi h $$<br>$$ 球缺体积 &#x3D; \pi \cdot h^2 \cdot (R - \frac{h}{3}) $$<br>$$ w&#x3D;\left(y+\lfloor {\frac {y}{4}}\rfloor+\lfloor{\frac {c}{4}}\rfloor-2c+\lfloor{\frac {26(m+1)}{10}}\rfloor+d-1\right){\bmod {7}} $$<br>$$ w：星期; c：年份前两位数; y：年份后两位数;m：月,某年的1、2月要看作上一年的13、14月来计算; d：日 $$</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/ACM/" rel="tag"># ACM</a>
              <a href="/tags/algorithm/" rel="tag"># algorithm</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/firstBlog/" rel="prev" title="firstBlog">
                  <i class="fa fa-angle-left"></i> firstBlog
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/create-hostapd-with-ipv4-6-support/" rel="next" title="create hostapd with ipv4&amp;6 support">
                  create hostapd with ipv4&6 support <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ankikong</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/ankikong" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
